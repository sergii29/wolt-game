<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Warsaw Courier Simulator</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* --- WOLT / WARSAW STYLE --- */
        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #121212; /* Dark theme */
            color: #fff;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
        }
        .app-container {
            width: 100%;
            max-width: 400px;
            height: 100vh;
            background: #121212;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* --- ANDROID LOGIN SCREEN --- */
        #android-auth {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #009de0; /* Wolt Blue vibe */
            z-index: 5000;
            display: none; /* JS –≤–∫–ª—é—á–∏—Ç –µ—Å–ª–∏ —ç—Ç–æ Android */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }
        .auth-logo { font-size: 4rem; margin-bottom: 20px; }
        .auth-title { font-size: 1.5rem; font-weight: bold; margin-bottom: 30px; }
        
        .input-box {
            width: 100%; margin-bottom: 15px;
        }
        .input-field {
            width: 100%; padding: 15px; border-radius: 8px; border: none;
            font-size: 1rem; outline: none; box-sizing: border-box;
        }
        .btn-auth {
            width: 100%; padding: 15px; border-radius: 8px; border: none;
            font-weight: bold; font-size: 1rem; cursor: pointer; margin-bottom: 10px;
            background: #fff; color: #009de0;
        }
        .btn-link {
            background: none; color: white; text-decoration: underline; cursor: pointer; border: none;
        }

        /* --- GAME UI --- */
        header {
            background: #202125;
            padding: 15px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #333;
        }
        .header-title { font-weight: 900; color: #009de0; letter-spacing: 1px; }
        .tg-link { 
            background: #2aabee; color: white; padding: 5px 12px; 
            border-radius: 20px; text-decoration: none; font-size: 0.8rem; font-weight: bold; 
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            padding: 15px;
            background: #1a1a1d;
        }
        .stat-card {
            background: #2c2c30; padding: 10px; border-radius: 8px; text-align: center;
        }
        .stat-label { font-size: 0.7rem; color: #aaa; text-transform: uppercase; }
        .stat-val { font-size: 1.1rem; font-weight: bold; }
        .money { color: #4caf50; }

        /* Main Work Area */
        .work-area {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/c/c2/Warsaw_Skyline_at_Sunset.jpg/640px-Warsaw_Skyline_at_Sunset.jpg');
            background-size: cover;
            background-position: center;
            position: relative;
        }
        .work-overlay {
            position: absolute; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.7);
        }

        .delivery-btn {
            position: relative;
            width: 220px; height: 220px;
            background: #009de0;
            border-radius: 50%;
            border: 5px solid #fff;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            box-shadow: 0 0 30px rgba(0, 157, 224, 0.4);
            cursor: pointer;
            transition: transform 0.1s;
            z-index: 2;
        }
        .delivery-btn:active { transform: scale(0.95); }
        .btn-text { font-size: 1.2rem; font-weight: bold; text-transform: uppercase; }
        .btn-sub { font-size: 0.8rem; opacity: 0.8; }

        /* Controls Footer */
        .controls {
            padding: 15px; background: #202125;
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
        }
        .control-btn {
            padding: 12px; border: none; border-radius: 8px;
            font-weight: bold; color: white; cursor: pointer;
            display: flex; flex-direction: column; align-items: center;
        }
        .btn-eat { background: #ff9800; }
        .btn-drink { background: #00bcd4; }
        .btn-auto { background: #9c27b0; grid-column: span 2; }
        .btn-logout { background: #d32f2f; grid-column: span 2; margin-top: 5px; display: none; }
        
        .cost { font-size: 0.7rem; opacity: 0.8; margin-top: 2px; }

    </style>
</head>
<body>

    <div class="app-container">
        
        <div id="android-auth">
            <div class="auth-logo">üéí</div>
            <div class="auth-title">WARSAW COURIER</div>
            
            <div id="form-login" style="width:100%;">
                <div class="input-box"><input id="l-user" class="input-field" type="text" placeholder="–õ–æ–≥–∏–Ω"></div>
                <div class="input-box"><input id="l-pass" class="input-field" type="password" placeholder="–ü–∞—Ä–æ–ª—å"></div>
                <button class="btn-auth" onclick="login()">–í–û–ô–¢–ò</button>
                <button class="btn-link" onclick="toggleForms()">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>

            <div id="form-reg" style="width:100%; display:none;">
                <div class="input-box"><input id="r-user" class="input-field" type="text" placeholder="–ü—Ä–∏–¥—É–º–∞–π –õ–æ–≥–∏–Ω"></div>
                <div class="input-box"><input id="r-pass" class="input-field" type="password" placeholder="–ü—Ä–∏–¥—É–º–∞–π –ü–∞—Ä–æ–ª—å"></div>
                <button class="btn-auth" onclick="register()">–°–û–ó–î–ê–¢–¨ –ê–ö–ö–ê–£–ù–¢</button>
                <button class="btn-link" onclick="toggleForms()">–ù–∞–∑–∞–¥ –∫–æ –≤—Ö–æ–¥—É</button>
            </div>
        </div>

        <header>
            <div class="header-title">COURIER APP</div>
            <a href="https://t.me/placeholder" class="tg-link">NEWS</a>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">–ë–∞–ª–∞–Ω—Å (PLN)</div>
                <div class="stat-val money" id="ui-bal">0.00</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–†–µ–π—Ç–∏–Ω–≥</div>
                <div class="stat-val" id="ui-rat">5.00</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–≠–Ω–µ—Ä–≥–∏—è ‚ö°</div>
                <div class="stat-val" id="ui-en">100%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–í–æ–¥–∞ üíß</div>
                <div class="stat-val" id="ui-wa">100%</div>
            </div>
        </div>

        <div class="work-area">
            <div class="work-overlay"></div>
            <div class="delivery-btn" onclick="deliver()">
                <span class="btn-text">–ü–†–ò–ù–Ø–¢–¨ –ó–ê–ö–ê–ó</span>
                <span class="btn-sub" id="ui-lvl">–£—Ä–æ–≤–µ–Ω—å 1</span>
            </div>
        </div>

        <div class="controls">
            <button class="control-btn btn-drink" onclick="buyWater()">
                <span>–ö–£–ü–ò–¢–¨ –í–û–î–£</span>
                <span class="cost">-10 PLN | +30%</span>
            </button>
            <button class="control-btn btn-eat" onclick="buyFood()">
                <span>–ü–û–ï–°–¢–¨</span>
                <span class="cost">-25 PLN | +20% En</span>
            </button>
            <button class="control-btn btn-auto" id="btn-auto" onclick="toggleAuto()">
                <span>–ê–í–¢–û-–ü–†–ò–ï–ú –ó–ê–ö–ê–ó–û–í</span>
                <span class="cost" id="auto-state">–í–´–ö–õ</span>
            </button>
            <button class="control-btn btn-logout" id="btn-out" onclick="logout()">
                –í–´–ô–¢–ò –ò–ó –ê–ö–ö–ê–£–ù–¢–ê
            </button>
        </div>

    </div>

    <script>
        // --- DATA ---
        let user = {
            id: 'local',
            bal: 0,
            rat: 5.0,
            lvl: 1,
            en: 100,
            wa: 100,
            pass: null // Only for Android users
        };

        // --- CONFIG ---
        const ANDROID_PREFIX = "wolt_andro_";
        const TG_PREFIX = "wolt_tg_";
        let storageKey = ""; 
        let isAuto = false;
        let autoInt = null;

        // --- INIT ---
        window.onload = () => {
            const tg = window.Telegram.WebApp;
            
            if(tg.initDataUnsafe && tg.initDataUnsafe.user) {
                // TELEGRAM MODE
                tg.expand();
                let uid = tg.initDataUnsafe.user.id;
                storageKey = TG_PREFIX + uid;
                loadData();
                startGame();
            } else {
                // ANDROID MODE
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –≤—Ö–æ–¥
                let lastLogin = localStorage.getItem("wolt_last_login");
                if(lastLogin) {
                    storageKey = ANDROID_PREFIX + lastLogin;
                    loadData(); // –ó–∞–≥—Ä—É–∂–∞–µ–º, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å (—Ñ–æ—Ä–º–∞–ª—å–Ω–æ)
                    startGame();
                    document.getElementById('btn-out').style.display = 'block'; // –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É –≤—ã—Ö–æ–¥–∞
                } else {
                    document.getElementById('android-auth').style.display = 'flex';
                }
            }
        }

        // --- AUTH LOGIC (ANDROID) ---
        function toggleForms() {
            let log = document.getElementById('form-login');
            let reg = document.getElementById('form-reg');
            if(log.style.display === 'none') {
                log.style.display = 'block'; reg.style.display = 'none';
            } else {
                log.style.display = 'none'; reg.style.display = 'block';
            }
        }

        function register() {
            let u = document.getElementById('r-user').value.trim();
            let p = document.getElementById('r-pass').value.trim();
            if(!u || !p) return alert("–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ!");
            
            let key = ANDROID_PREFIX + u;
            if(localStorage.getItem(key)) return alert("–õ–æ–≥–∏–Ω –∑–∞–Ω—è—Ç!");

            // Create new user
            let newUser = { ...user, id: u, pass: p };
            localStorage.setItem(key, JSON.stringify(newUser));
            alert("–ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ.");
            toggleForms();
        }

        function login() {
            let u = document.getElementById('l-user').value.trim();
            let p = document.getElementById('l-pass').value.trim();
            if(!u || !p) return alert("–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ!");

            let key = ANDROID_PREFIX + u;
            let data = localStorage.getItem(key);
            
            if(!data) return alert("–ù–µ—Ç —Ç–∞–∫–æ–≥–æ –∫—É—Ä—å–µ—Ä–∞.");
            
            let parsed = JSON.parse(data);
            if(parsed.pass === p) {
                storageKey = key;
                localStorage.setItem("wolt_last_login", u);
                user = parsed;
                document.getElementById('android-auth').style.display = 'none';
                document.getElementById('btn-out').style.display = 'block';
                startGame();
            } else {
                alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!");
            }
        }

        function logout() {
            saveData();
            localStorage.removeItem("wolt_last_login");
            location.reload();
        }

        // --- GAMEPLAY ---
        function startGame() {
            updateUI();
            setInterval(saveData, 5000); // Save every 5s
            setInterval(() => { // Passive Drain
                 if(!isAuto) {
                     // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Å—Å–∏–≤–Ω—ã–π —Ä–∞—Å—Ö–æ–¥, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å, –ø–æ–∫–∞ –æ—Ç–∫–ª—é—á–∏–ª –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã
                 }
            }, 10000);
        }

        function deliver() {
            if(user.en <= 0 || user.wa <= 0) {
                if(isAuto) toggleAuto();
                return alert("–í—ã —É—Å—Ç–∞–ª–∏! –ù—É–∂–Ω–∞ –µ–¥–∞ –∏–ª–∏ –≤–æ–¥–∞.");
            }

            // Calculation
            let basePay = 1.5 + (user.lvl * 0.5);
            let earn = basePay * (user.rat / 2);
            
            user.bal += earn;
            user.en -= 0.5;
            user.wa -= 0.8;
            
            checkLvl();
            updateUI();
        }

        function buyWater() {
            if(user.bal >= 10) {
                user.bal -= 10;
                user.wa = Math.min(100, user.wa + 30);
                updateUI();
            } else alert("–ú–∞–ª–æ –¥–µ–Ω–µ–≥!");
        }

        function buyFood() {
            if(user.bal >= 25) {
                user.bal -= 25;
                user.en = Math.min(100, user.en + 20);
                updateUI();
            } else alert("–ú–∞–ª–æ –¥–µ–Ω–µ–≥!");
        }

        function toggleAuto() {
            if(isAuto) {
                isAuto = false;
                clearInterval(autoInt);
                document.getElementById('auto-state').innerText = "–í–´–ö–õ";
                document.getElementById('btn-auto').style.border = "none";
            } else {
                isAuto = true;
                document.getElementById('auto-state').innerText = "–ê–ö–¢–ò–í–ù–û";
                document.getElementById('btn-auto').style.border = "2px solid #fff";
                autoInt = setInterval(() => {
                    if(user.en > 0 && user.wa > 0) deliver();
                    else toggleAuto();
                }, 1000);
            }
        }

        function checkLvl() {
            if(user.bal > user.lvl * 500) {
                user.lvl++;
            }
        }

        function updateUI() {
            document.getElementById('ui-bal').innerText = user.bal.toFixed(2);
            document.getElementById('ui-rat').innerText = user.rat.toFixed(2);
            document.getElementById('ui-lvl').innerText = "–£—Ä–æ–≤–µ–Ω—å " + user.lvl;
            document.getElementById('ui-en').innerText = Math.floor(user.en) + "%";
            document.getElementById('ui-wa').innerText = Math.floor(user.wa) + "%";
        }

        function loadData() {
            let d = localStorage.getItem(storageKey);
            if(d) {
                let p = JSON.parse(d);
                user.bal = p.bal || 0;
                user.rat = p.rat || 5.0;
                user.lvl = p.lvl || 1;
                user.en = p.en !== undefined ? p.en : 100;
                user.wa = p.wa !== undefined ? p.wa : 100;
                user.pass = p.pass; // Keep pass safe
            }
        }

        function saveData() {
            if(!storageKey) return;
            localStorage.setItem(storageKey, JSON.stringify(user));
        }

    </script>
</body>
</html>
