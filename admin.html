<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOD MODE v8.0</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #f4f6f8; font-family: 'Segoe UI', sans-serif; padding: 15px; font-size: 13px; color: #333; }
        .header { background: white; padding: 15px; border-radius: 12px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .status { font-weight: bold; color: #ccc; font-size: 11px; } .status.on { color: #00c853; }
        
        /* TABS */
        .nav { display: flex; gap: 8px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 5px; }
        .nav-btn { flex: 1; padding: 12px; background: white; border: 1px solid #dfe6e9; border-radius: 8px; cursor: pointer; font-weight: 700; color: #636e72; min-width: 100px; white-space: nowrap; transition: 0.2s; }
        .nav-btn.active { background: #0984e3; color: white; border-color: #0984e3; box-shadow: 0 4px 10px rgba(9, 132, 227, 0.3); }
        .view { display: none; animation: fadeIn 0.3s; } .view.active { display: block; }
        @keyframes fadeIn { from { opacity:0; transform:translateY(5px); } to { opacity:1; transform:translateY(0); } }

        /* CARDS */
        .card { background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; border: 1px solid #dfe6e9; box-shadow: 0 2px 5px rgba(0,0,0,0.03); }
        .card h3 { margin: 0 0 15px 0; font-size: 14px; text-transform: uppercase; color: #0984e3; border-bottom: 2px solid #f1f2f6; padding-bottom: 10px; }
        
        /* ROCKET PLANNER */
        .rk-form { display: grid; gap: 10px; }
        .rk-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .rk-label { font-size: 11px; font-weight: 700; color: #636e72; margin-bottom: 4px; display: block; }
        input, select { width: 100%; padding: 10px; border: 1px solid #b2bec3; border-radius: 6px; font-size: 13px; box-sizing: border-box; }
        input:focus { outline: 2px solid #0984e3; border-color: transparent; }
        
        .bonus-list { margin-top: 15px; }
        .bonus-item { background: white; padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 5px solid #ccc; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .bonus-item.active { border-left-color: #00c853; }
        .bonus-item.future { border-left-color: #ff9800; }
        .bonus-item.ended { border-left-color: #b2bec3; opacity: 0.6; }
        
        .tag { padding: 3px 8px; border-radius: 12px; font-size: 10px; font-weight: bold; color: white; margin-left: 5px; }
        .tag.active { background: #00c853; } .tag.future { background: #ff9800; } .tag.ended { background: #b2bec3; }

        .btn { width: 100%; padding: 12px; border: none; border-radius: 8px; font-weight: bold; color: white; cursor: pointer; margin-top: 10px; font-size: 14px; }
        .btn-blue { background: #0984e3; } .btn-green { background: #00b894; } .btn-red { background: #d63031; }
        
        /* PLAYER LIST */
        .p-item { background: white; padding: 12px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; border: 1px solid #dfe6e9; }
        .p-item:hover { border-color: #0984e3; }
        .p-on { color: #00b894; font-weight: bold; font-size: 10px; }
        .p-off { color: #b2bec3; font-size: 10px; }

        /* MODAL */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 999; justify-content: center; align-items: center; }
        .modal.open { display: flex; }
        .modal-box { background: white; width: 90%; max-width: 400px; padding: 25px; border-radius: 16px; max-height: 90vh; overflow-y: auto; }
    </style>
</head>
<body>

<div class="header">
    <h2 style="margin:0">üöÄ COMMAND CENTER <span style="font-size:12px; color:#aaa">v8.0</span></h2>
    <div id="status" class="status">DISCONNECTED</div>
</div>

<div class="nav">
    <button class="nav-btn active" onclick="tab('rocket')">üì¢ –ê–∫—Ü–∏–∏ (–†–∞–∫–µ—Ç–∞)</button>
    <button class="nav-btn" onclick="tab('players')">üë• –ò–≥—Ä–æ–∫–∏</button>
    <button class="nav-btn" onclick="tab('tariffs')">üí∏ –¢–∞—Ä–∏—Ñ—ã</button>
</div>

<div id="rocket" class="view active">
    <div class="card">
        <h3>üìù –°–æ–∑–¥–∞—Ç—å –ù–æ–≤—É—é –ê–∫—Ü–∏—é</h3>
        <div class="rk-form">
            <div><span class="rk-label">–ó–∞–≥–æ–ª–æ–≤–æ–∫ (–ß—Ç–æ —É–≤–∏–¥—è—Ç –∏–≥—Ä–æ–∫–∏?)</span><input id="rk-title" placeholder="–ü—Ä–∏–º–µ—Ä: –£—Ç—Ä–µ–Ω–Ω—è—è –ó–∞—Ä—è–¥–∫–∞"></div>
            
            <div class="rk-row">
                <div><span class="rk-label">–¶–µ–ª—å (–ó–∞–∫–∞–∑—ã)</span><input type="number" id="rk-target" placeholder="10"></div>
                <div><span class="rk-label">–ù–∞–≥—Ä–∞–¥–∞ (PLN)</span><input type="number" id="rk-reward" placeholder="150"></div>
            </div>

            <div class="rk-row">
                <div><span class="rk-label">–°—Ç–∞—Ä—Ç (–î–∞—Ç–∞/–í—Ä–µ–º—è)</span><input type="datetime-local" id="rk-start"></div>
                <div><span class="rk-label">–§–∏–Ω–∏—à (–î–∞—Ç–∞/–í—Ä–µ–º—è)</span><input type="datetime-local" id="rk-end"></div>
            </div>
            
            <button class="btn btn-blue" onclick="createBonus()">–î–û–ë–ê–í–ò–¢–¨ –í –†–ê–°–ü–ò–°–ê–ù–ò–ï</button>
        </div>
    </div>

    <div class="card">
        <h3>üìÖ –¢–µ–∫—É—â–µ–µ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h3>
        <p style="color:#666; font-size:12px">–ó–¥–µ—Å—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ü–∏–π. –ò–≥—Ä–æ–∫–∏ –≤–∏–¥—è—Ç –∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</p>
        <div id="bonus-list" class="bonus-list">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <button class="btn btn-red" onclick="if(confirm('–£–¥–∞–ª–∏—Ç—å –í–°–ï –∞–∫—Ü–∏–∏?')) db.ref('bonuses/list').remove()">–û–ß–ò–°–¢–ò–¢–¨ –í–°–Å</button>
    </div>
</div>

<div id="players" class="view">
    <input type="text" id="p-search" placeholder="üîç –ü–æ–∏—Å–∫..." onkeyup="renderPlayers()" style="width:100%; padding:12px; box-sizing:border-box; margin-bottom:15px; border-radius:8px; border:1px solid #ccc">
    <div id="p-list">Loading...</div>
</div>

<div id="tariffs" class="view">
    <div class="card">
        <h3>–≠–∫–æ–Ω–æ–º–∏–∫–∞</h3>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px">
            <div><span class="rk-label">–ü–æ–¥–∞—á–∞ (PLN)</span><input type="number" id="basePay"></div>
            <div><span class="rk-label">–ö–ú (PLN)</span><input type="number" id="kmPay"></div>
            <div><span class="rk-label">–¢–∞–∫—Å–∏ (x)</span><input type="number" id="taxiMulti"></div>
            <div><span class="rk-label">–ö—Ä–µ–¥–∏—Ç (–ë–∞–∑–∞)</span><input type="number" id="bankBase"></div>
        </div>
        <button class="btn btn-green" onclick="saveConfig()">–ü–†–ò–ú–ï–ù–ò–¢–¨ –ù–ê–°–¢–†–û–ô–ö–ò</button>
    </div>
</div>

<div id="modal" class="modal">
    <div class="modal-box">
        <h2 id="m-name" style="margin-top:0">–ò–≥—Ä–æ–∫</h2>
        <div style="margin-bottom:15px">
            <span class="rk-label">–ë–∞–ª–∞–Ω—Å</span>
            <input type="number" id="m-bal">
        </div>
        <div style="display:flex; gap:10px">
            <button class="btn" style="background:#ffc107; color:black" onclick="giveTaxi()">üéÅ –î–ê–¢–¨ –¢–ê–ö–°–ò</button>
            <button class="btn btn-red" onclick="banUser()">–ë–ê–ù</button>
        </div>
        <button class="btn btn-green" onclick="saveUser()">–°–û–•–†–ê–ù–ò–¢–¨</button>
        <button class="btn" style="background:#b2bec3; color:black" onclick="closeModal()">–ó–ê–ö–†–´–¢–¨</button>
    </div>
</div>

<script>
    const fb = { apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk", authDomain: "warszawa-courier.firebaseapp.com", databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app", projectId: "warszawa-courier", storageBucket: "warszawa-courier.firebasestorage.app", messagingSenderId: "295860613508", appId: "1:295860613508:web:86fe8364377d6875612dd1" };
    firebase.initializeApp(fb);
    const db = firebase.database();
    let players={}, bonuses=[], activeId=null;

    db.ref('.info/connected').on('value', s => {
        document.getElementById('status').innerText = s.val() ? 'ONLINE' : 'OFFLINE';
        document.getElementById('status').className = s.val() ? 'status on' : 'status';
    });

    db.ref('players').on('value', s => { players = s.val() || {}; renderPlayers(); });
    
    // ROCKET LISTENER
    db.ref('bonuses/list').on('value', s => {
        const d = s.val() || {};
        bonuses = Object.entries(d).map(([k,v]) => ({id:k, ...v}));
        renderBonuses();
    });

    db.ref('config').on('value', s => {
        const c = s.val() || {};
        const set = (id, v) => { if(document.getElementById(id)) document.getElementById(id).value = v; };
        set('basePay', c.basePickupPay||4); set('kmPay', c.perKmPay||1.5); 
        set('taxiMulti', c.taxiMulti||4); set('bankBase', c.bankLimitBase||1000);
    });

    function createBonus() {
        const title = document.getElementById('rk-title').value;
        const target = parseInt(document.getElementById('rk-target').value);
        const reward = parseFloat(document.getElementById('rk-reward').value);
        const startVal = document.getElementById('rk-start').value;
        const endVal = document.getElementById('rk-end').value;

        if(!title || !target || !reward || !startVal || !endVal) return alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
        
        const start = new Date(startVal).getTime();
        const end = new Date(endVal).getTime();

        if(end <= start) return alert('–û—à–∏–±–∫–∞: –î–∞—Ç–∞ –∫–æ–Ω—Ü–∞ —Ä–∞–Ω—å—à–µ –Ω–∞—á–∞–ª–∞!');

        db.ref('bonuses/list').push({ title, target, reward, startTime: start, endTime: end });
        alert('–ê–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞!');
    }

    function renderBonuses() {
        const c = document.getElementById('bonus-list'); c.innerHTML = '';
        const now = Date.now();
        bonuses.sort((a,b) => a.startTime - b.startTime);

        bonuses.forEach(b => {
            let cl = 'future', txt = '–°–ö–û–†–û';
            if(now >= b.startTime && now <= b.endTime) { cl = 'active'; txt = '–ê–ö–¢–ò–í–ù–ê'; }
            if(now > b.endTime) { cl = 'ended'; txt = '–ó–ê–í–ï–†–®–ï–ù–ê'; }

            const sDate = new Date(b.startTime).toLocaleString('ru-RU', {day:'numeric', month:'short', hour:'2-digit', minute:'2-digit'});
            const eDate = new Date(b.endTime).toLocaleString('ru-RU', {hour:'2-digit', minute:'2-digit'});

            c.innerHTML += `
            <div class="bonus-item ${cl}">
                <div>
                    <div style="font-weight:bold; font-size:14px">${b.title} <span class="tag ${cl}">${txt}</span></div>
                    <div style="font-size:11px; color:#555; margin-top:2px">–¶–µ–ª—å: ${b.target} –∑–∞–∫. | –ù–∞–≥—Ä–∞–¥–∞: ${b.reward} PLN</div>
                    <div style="font-size:10px; color:#888; margin-top:2px">${sDate} - ${eDate}</div>
                </div>
                <button onclick="db.ref('bonuses/list/${b.id}').remove()" style="border:none; background:none; color:red; font-weight:bold; cursor:pointer">X</button>
            </div>`;
        });
        if(bonuses.length===0) c.innerHTML = '<div style="text-align:center; padding:10px">–ù–µ—Ç –∞–∫—Ü–∏–π</div>';
    }

    function tab(id) {
        document.querySelectorAll('.view').forEach(e=>e.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(e=>e.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        event.target.classList.add('active');
    }

    function renderPlayers() {
        const c = document.getElementById('p-list'); c.innerHTML = '';
        const s = document.getElementById('p-search').value.toLowerCase();
        const arr = Object.entries(players).map(([k,v]) => ({id:k, ...v})).filter(p => (p.name||'').toLowerCase().includes(s));
        arr.forEach(p => {
            const on = (Date.now() - (p.lastSeen||0) < 15000);
            c.innerHTML += `<div class="p-item" onclick="edit('${p.id}')">
                <div><b>${p.name||'Guest'}</b><br><span class="${on?'p-on':'p-off'}">${on?'‚óè ONLINE':'‚óã OFFLINE'}</span></div>
                <div style="font-weight:bold">${(p.balance||0).toFixed(2)} PLN</div>
            </div>`;
        });
    }

    function edit(id) {
        activeId=id; document.getElementById('modal').classList.add('open');
        document.getElementById('m-name').innerText = players[id].name;
        document.getElementById('m-bal').value = players[id].balance;
    }
    function closeModal() { document.getElementById('modal').classList.remove('open'); activeId=null; }
    function saveUser() { db.ref('players/'+activeId).update({balance:parseFloat(document.getElementById('m-bal').value)}); closeModal(); }
    function giveTaxi() { if(confirm('–í—ã–¥–∞—Ç—å —Ç–∞–∫—Å–∏?')) db.ref('players/'+activeId+'/taxi').update({unlocked:true, vehicle:'tesla', licenses:{driver:true, insurance:true, taxi:true}}); }
    function banUser() { db.ref('players/'+activeId).update({isBanned: !players[activeId].isBanned}); closeModal(); }
    function saveConfig() {
        const get = i => parseFloat(document.getElementById(i).value);
        db.ref('config').update({ basePickupPay: get('basePay'), perKmPay: get('kmPay'), taxiMulti: get('taxiMulti'), bankLimitBase: get('bankBase') });
        alert('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ');
    }
</script>
</body>
</html>

