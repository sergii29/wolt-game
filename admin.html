<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WARSZAWA CONTROL CENTER [MASTER]</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #121212; color: #e0e0e0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; margin: 0; padding: 15px; padding-bottom: 50px; }
        h1 { color: #00e5ff; margin: 0; font-size: 20px; text-transform: uppercase; letter-spacing: 1px; }
        
        /* TABS */
        .tabs { display: flex; gap: 10px; margin: 20px 0; background: #1e1e1e; padding: 5px; border-radius: 12px; overflow-x: auto; }
        .tab-btn { flex: 1; background: transparent; color: #777; border: none; padding: 12px; font-weight: bold; cursor: pointer; border-radius: 8px; transition: all 0.2s; white-space: nowrap; }
        .tab-btn.active { background: #333; color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }

        .panel { display: none; animation: fadeIn 0.3s; }
        .panel.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* PLAYERS LIST */
        .player-card { background: #1e1e1e; padding: 15px; margin-bottom: 10px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; border-left: 4px solid #444; position: relative; }
        .player-card.online { border-left-color: #00e676; }
        .player-card.banned { border-left-color: #ff3d00; opacity: 0.6; }
        .p-name { font-weight: bold; font-size: 15px; color: white; }
        .p-id { font-size: 11px; color: #666; font-family: monospace; }
        .p-bal { color: #00e5ff; font-weight: bold; margin-top: 5px; }
        .btn-edit { background: #333; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: bold; }

        /* ACCOUNTS TABLE (DATABASE) */
        .acc-table { width: 100%; border-collapse: collapse; font-size: 13px; background: #1e1e1e; border-radius: 10px; overflow: hidden; }
        .acc-table th { text-align: left; padding: 12px; background: #252525; color: #00e5ff; border-bottom: 2px solid #333; }
        .acc-table td { padding: 12px; border-bottom: 1px solid #333; color: #ccc; }
        .acc-row:hover { background: #2c2c2c; }
        .pass-badge { background: #333; padding: 4px 8px; border-radius: 4px; color: #ff9100; font-family: monospace; font-weight: bold; }

        /* SETTINGS & INPUTS */
        .setting-group { background: #1e1e1e; padding: 15px; border-radius: 12px; margin-bottom: 15px; border: 1px solid #333; }
        .setting-group h3 { margin: 0 0 15px 0; color: #aaa; font-size: 12px; text-transform: uppercase; border-bottom: 1px solid #333; padding-bottom: 5px; }
        .input-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .input-label { font-size: 13px; color: #ccc; }
        
        input[type="number"], input[type="text"] { background: #2c2c2c; border: 1px solid #444; color: #fff; padding: 8px; border-radius: 6px; width: 80px; text-align: right; font-weight: bold; }
        input[type="range"] { flex: 1; margin: 0 10px; accent-color: #00e5ff; }

        /* MODAL */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 999; justify-content: center; align-items: center; }
        .modal.open { display: flex; }
        .modal-box { background: #18181b; width: 90%; max-width: 450px; border-radius: 16px; padding: 20px; max-height: 90vh; overflow-y: auto; border: 1px solid #333; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .live-badge { background: #ff3d00; color: white; padding: 2px 6px; border-radius: 4px; font-size: 9px; font-weight: bold; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        .btn { width: 100%; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-green { background: #00e676; color: black; }
        .btn-blue { background: #009de0; color: white; }
        .btn-red { background: rgba(255, 61, 0, 0.2); color: #ff3d00; border: 1px solid #ff3d00; }
        
        /* LOGS */
        .log-table { width: 100%; font-size: 12px; border-collapse: collapse; }
        .log-table td { padding: 8px; border-bottom: 1px solid #333; color: #aaa; }
        .log-type { font-weight: bold; padding: 2px 5px; border-radius: 4px; font-size: 10px; }
    </style>
</head>
<body>

    <div style="display:flex; justify-content:space-between; align-items:center">
        <h1>Admin Panel <span style="font-size:10px; color:#555">v3.0 MASTER</span></h1>
        <div id="status" style="font-size:10px; color:#555">Connecting...</div>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="setTab('players')">–ò–≥—Ä–æ–∫–∏</button>
        <button class="tab-btn" onclick="setTab('accounts')" style="color:#ff9100">üîê –ê–∫–∫–∞—É–Ω—Ç—ã</button>
        <button class="tab-btn" onclick="setTab('settings')">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        <button class="tab-btn" onclick="setTab('logs')">–ñ—É—Ä–Ω–∞–ª</button>
    </div>

    <div id="players" class="panel active">
        <input type="text" id="search" placeholder="üîç –ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞..." style="width:100%; box-sizing:border-box; padding:12px; margin-bottom:15px;" onkeyup="renderPlayers()">
        <div id="players-list">Loading...</div>
    </div>

    <div id="accounts" class="panel">
        <div class="setting-group">
            <h3>–†–µ–µ—Å—Ç—Ä –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–õ–æ–≥–∏–Ω/–ü–∞—Ä–æ–ª—å)</h3>
            <p style="font-size:12px; color:#666; margin-bottom:15px">–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞.</p>
            
            <input type="text" id="acc-search" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –ª–æ–≥–∏–Ω—É..." style="width:100%; box-sizing:border-box; padding:12px; margin-bottom:10px;" onkeyup="renderAccounts()">
            
            <div style="overflow-x:auto">
                <table class="acc-table">
                    <thead>
                        <tr>
                            <th>–õ–æ–≥–∏–Ω</th>
                            <th>–ü–∞—Ä–æ–ª—å</th>
                            <th>ID –ò–≥—Ä–æ–∫–∞</th>
                        </tr>
                    </thead>
                    <tbody id="accounts-list">
                        <tr><td colspan="3">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="settings" class="panel">
        <div class="setting-group">
            <h3>üí∏ –≠–∫–æ–Ω–æ–º–∏–∫–∞</h3>
            <div class="input-row"><span class="input-label">–ë–∞–∑–æ–≤–∞—è –ø–æ–¥–∞—á–∞ (PLN)</span> <input type="number" id="cfg-basePickupPay"></div>
            <div class="input-row"><span class="input-label">–û–ø–ª–∞—Ç–∞ –∑–∞ –ö–ú (PLN)</span> <input type="number" id="cfg-perKmPay"></div>
            <div class="input-row"><span class="input-label">–†–∞–∑–±—Ä–æ—Å —Ü–µ–Ω—ã (+/-)</span> <input type="number" id="cfg-payVariance"></div>
            <div class="input-row"><span class="input-label">–ò–Ω—Ñ–ª—è—Ü–∏—è –∑–∞ —É—Ä–æ–≤–µ–Ω—å (%)</span> <input type="number" id="cfg-inflationRate"></div>
        </div>

        <div class="setting-group">
            <h3>‚òï –ß–∞–µ–≤—ã–µ</h3>
            <div class="input-row"><span class="input-label">–®–∞–Ω—Å —á–∞–µ–≤—ã—Ö (0.1 - 1.0)</span> <input type="number" id="cfg-tipChance" step="0.1"></div>
            <div class="input-row"><span class="input-label">–ú–∏–Ω. –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</span> <input type="number" id="cfg-tipMinTemp"></div>
            <div class="input-row"><span class="input-label">–ú–∏–Ω. –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</span> <input type="number" id="cfg-tipMinMood"></div>
        </div>

        <div class="setting-group">
            <h3>‚ö° –°–ª–æ–∂–Ω–æ—Å—Ç—å</h3>
            <div class="input-row"><span class="input-label">–¢—Ä–∞—Ç–∞ –≠–Ω–µ—Ä–≥–∏–∏</span> <input type="number" id="cfg-energyDrain" step="0.01"></div>
            <div class="input-row"><span class="input-label">–¢—Ä–∞—Ç–∞ –í–æ–¥—ã</span> <input type="number" id="cfg-waterDrain" step="0.01"></div>
            <div class="input-row"><span class="input-label">–í—Ä–µ–º—è –Ω–∞ –∑–∞–∫–∞–∑ (—Å–µ–∫)</span> <input type="number" id="cfg-deliveryTime"></div>
        </div>

        <div class="setting-group">
            <h3>üçé –¶–µ–Ω—ã –ú–∞–≥–∞–∑–∏–Ω–∞</h3>
            <div class="input-row"><span class="input-label">–í–æ–¥–∞</span> <input type="number" id="price-water"></div>
            <div class="input-row"><span class="input-label">–°–Ω–∏–∫–µ—Ä—Å</span> <input type="number" id="price-bar"></div>
            <div class="input-row"><span class="input-label">Red Bull</span> <input type="number" id="price-energy_drink"></div>
        </div>

        <button class="btn btn-green" onclick="saveGlobalConfig()">üíæ –ü–†–ò–ú–ï–ù–ò–¢–¨ –ö–û –í–°–ï–ú</button>
    </div>

    <div id="logs" class="panel">
        <table class="log-table">
            <tbody id="log-body"></tbody>
        </table>
    </div>

    <div id="editModal" class="modal">
        <div class="modal-box">
            <div class="modal-header">
                <div>
                    <h2 style="margin:0; font-size:18px" id="ed-name">Player</h2>
                    <span style="font-size:10px; color:#666" id="ed-id">ID</span>
                </div>
                <span class="live-badge">LIVE</span>
            </div>

            <div class="setting-group">
                <h3>–§–∏–Ω–∞–Ω—Å—ã</h3>
                <div class="input-row">
                    <span class="input-label">üí∞ –ë–∞–ª–∞–Ω—Å</span>
                    <input type="number" id="ed-balance" step="0.01">
                </div>
                <div class="input-row">
                    <span class="input-label">üè¶ –î–æ–ª–≥</span>
                    <input type="number" id="ed-debt" step="0.01">
                </div>
                <button class="btn btn-blue" onclick="savePlayerFinance()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –î–µ–Ω—å–≥–∏</button>
            </div>

            <div class="setting-group">
                <h3>–°–æ—Å—Ç–æ—è–Ω–∏–µ</h3>
                <div class="input-row">
                    <span class="input-label">‚ö° –≠–Ω–µ—Ä–≥–∏—è</span>
                    <input type="range" id="rng-energy" min="0" max="100" oninput="document.getElementById('val-energy').innerText=this.value">
                    <span id="val-energy" style="width:30px; text-align:right">100</span>
                </div>
                <div class="input-row">
                    <span class="input-label">üíß –í–æ–¥–∞</span>
                    <input type="range" id="rng-water" min="0" max="100" oninput="document.getElementById('val-water').innerText=this.value">
                    <span id="val-water" style="width:30px; text-align:right">100</span>
                </div>
                <div class="input-row">
                    <span class="input-label">üòé –ù–∞—Å—Ç—Ä.</span>
                    <input type="range" id="rng-mood" min="0" max="100" oninput="document.getElementById('val-mood').innerText=this.value">
                    <span id="val-mood" style="width:30px; text-align:right">100</span>
                </div>
                <button class="btn btn-blue" onclick="savePlayerStats()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –°—Ç–∞—Ç—ã</button>
            </div>

            <div class="setting-group">
                <h3>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h3>
                <div class="input-row"><span class="input-label">ü•§ –í–æ–¥–∞</span> <input type="number" id="inv-water"></div>
                <div class="input-row"><span class="input-label">üç´ –°–Ω–∏–∫–µ—Ä—Å</span> <input type="number" id="inv-bar"></div>
                <div class="input-row"><span class="input-label">üöÄ Red Bull</span> <input type="number" id="inv-energy_drink"></div>
                <button class="btn btn-blue" onclick="savePlayerInv()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
            </div>
            
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px">
                <button class="btn" style="background:#ffcc00; color:black" onclick="unlockTaxi()">üöñ TAXI UNLOCK</button>
                <button id="btn-ban" class="btn btn-red" onclick="toggleBan()">üö´ BAN</button>
            </div>

            <button class="btn" style="background:#333; margin-top:20px" onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        // CONFIG
        const firebaseConfig = {
          apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk",
          authDomain: "warszawa-courier.firebaseapp.com",
          databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app",
          projectId: "warszawa-courier",
          storageBucket: "warszawa-courier.firebasestorage.app",
          messagingSenderId: "295860613508",
          appId: "1:295860613508:web:86fe8364377d6875612dd1"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        
        let allPlayers = [];
        let allAccounts = [];
        let activePlayerId = null;
        let activeListener = null;

        // CONNECTION
        db.ref('.info/connected').on('value', s => {
            const el = document.getElementById('status');
            el.textContent = s.val() ? "ONLINE" : "OFFLINE";
            el.style.color = s.val() ? "#00e676" : "#555";
        });

        // 1. PLAYERS LISTENER
        db.ref('players').on('value', snap => {
            const data = snap.val() || {};
            allPlayers = Object.entries(data).map(([id, p]) => ({id, ...p}));
            renderPlayers();
        });

        // 2. ACCOUNTS LISTENER (–í–æ—Ç —ç—Ç–∞ —á–∞—Å—Ç—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ª–æ–≥–∏–Ω—ã –∏ –ø–∞—Ä–æ–ª–∏)
        db.ref('users_lookup').on('value', snap => {
            const data = snap.val() || {};
            allAccounts = Object.entries(data).map(([login, d]) => ({
                login: login,
                pass: d.pass,
                playerId: d.playerId
            }));
            renderAccounts();
        });

        // 3. CONFIG LISTENER
        db.ref('config').on('value', snap => {
            const cfg = snap.val() || {};
            const setVal = (id, val) => { const el = document.getElementById(id); if(document.activeElement !== el) el.value = val; };

            setVal('cfg-basePickupPay', cfg.basePickupPay || 4.0);
            setVal('cfg-perKmPay', cfg.perKmPay || 1.5);
            setVal('cfg-payVariance', cfg.payVariance || 2.0);
            setVal('cfg-inflationRate', (cfg.inflationRate || 0.1) * 100);
            setVal('cfg-tipChance', cfg.tipChance || 0.5);
            setVal('cfg-tipMinTemp', cfg.tipMinTemp || 60);
            setVal('cfg-tipMinMood', cfg.tipMinMood || 80);
            setVal('cfg-energyDrain', cfg.energyDrain || 0.15);
            setVal('cfg-waterDrain', cfg.waterDrain || 0.10);
            setVal('cfg-deliveryTime', cfg.deliveryTime || 60);

            const prices = cfg.itemPrices || {};
            setVal('price-water', prices.water || 2.0);
            setVal('price-bar', prices.bar || 4.5);
            setVal('price-energy_drink', prices.energy_drink || 7.0);
        });

        // 4. LOGS LISTENER
        db.ref('logs').limitToLast(50).on('value', snap => {
            const data = snap.val();
            const tbody = document.getElementById('log-body');
            tbody.innerHTML = '';
            if(!data) return;
            Object.values(data).reverse().forEach(log => {
                const date = new Date(log.timestamp).toLocaleTimeString();
                const color = log.type === 'BAN' ? 'red' : (log.type === 'MONEY' ? '#00e676' : '#aaa');
                tbody.innerHTML += `<tr><td style="color:#666">${date}</td><td style="color:white">${log.playerName || '???'}</td><td><span class="log-type" style="color:${color}">${log.type}</span></td><td>${log.message}</td></tr>`;
            });
        });

        // TABS
        function setTab(id) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.target.classList.add('active');
        }

        // RENDER FUNCTIONS
        function renderPlayers() {
            const list = document.getElementById('players-list');
            const term = document.getElementById('search').value.toLowerCase();
            list.innerHTML = '';

            const filtered = allPlayers.filter(p => (p.name && p.name.toLowerCase().includes(term)) || p.id.includes(term));
            filtered.sort((a,b) => {
                const aOn = (Date.now() - (a.lastSeen||0) < 15000);
                const bOn = (Date.now() - (b.lastSeen||0) < 15000);
                if(aOn && !bOn) return -1;
                if(!aOn && bOn) return 1;
                return (b.balance||0) - (a.balance||0);
            });

            filtered.forEach(p => {
                const isOnline = (Date.now() - (p.lastSeen||0) < 15000);
                list.innerHTML += `
                    <div class="player-card ${isOnline?'online':''} ${p.isBanned?'banned':''}">
                        <div>
                            <div class="p-name">${p.name || '–ë–µ–∑ –∏–º–µ–Ω–∏'} ${p.isBanned ? '<span style="color:red">[BAN]</span>' : ''}</div>
                            <div class="p-id">${p.id}</div>
                            <div class="p-bal">${(p.balance||0).toFixed(2)} PLN</div>
                        </div>
                        <button class="btn-edit" onclick="openEdit('${p.id}')">EDIT</button>
                    </div>
                `;
            });
        }

        function renderAccounts() {
            const tbody = document.getElementById('accounts-list');
            const term = document.getElementById('acc-search').value.toLowerCase();
            tbody.innerHTML = '';

            const filtered = allAccounts.filter(a => a.login.toLowerCase().includes(term) || (a.playerId && a.playerId.includes(term)));

            if(filtered.length === 0) { tbody.innerHTML = '<tr><td colspan="3" style="text-align:center; padding:15px; color:#555">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td></tr>'; return; }

            filtered.forEach(acc => {
                tbody.innerHTML += `
                    <tr class="acc-row">
                        <td style="color:#fff; font-weight:bold">${acc.login}</td>
                        <td><span class="pass-badge">${acc.pass}</span></td>
                        <td style="font-family:monospace; color:#888">${acc.playerId}</td>
                    </tr>
                `;
            });
        }

        // EDIT MODAL
        function openEdit(id) {
            activePlayerId = id;
            document.getElementById('editModal').classList.add('open');
            if(activeListener) db.ref('players/' + id).off('value', activeListener);
            
            activeListener = db.ref('players/' + id).on('value', snap => {
                const p = snap.val();
                if(!p) return;
                document.getElementById('ed-name').innerText = p.name || 'Unknown';
                document.getElementById('ed-id').innerText = id;

                const setVal = (eid, val) => { if(document.activeElement !== document.getElementById(eid)) document.getElementById(eid).value = val; };
                const setTxt = (eid, val) => document.getElementById(eid).innerText = val;

                setVal('ed-balance', p.balance || 0);
                setVal('ed-debt', p.debt || 0);

                const s = p.stats || p.needs || {energy:100, water:100, mood:100};
                setVal('rng-energy', s.energy||100); setTxt('val-energy', Math.floor(s.energy||100));
                setVal('rng-water', s.water||100);   setTxt('val-water', Math.floor(s.water||100));
                setVal('rng-mood', s.mood||100);     setTxt('val-mood', Math.floor(s.mood||100));

                const inv = p.inventory || {};
                setVal('inv-water', inv.water||0); setVal('inv-bar', inv.bar||0); setVal('inv-energy_drink', inv.energy_drink||0);

                const banBtn = document.getElementById('btn-ban');
                if(p.isBanned) { banBtn.innerText = "–†–ê–ó–ë–ê–ù–ò–¢–¨"; banBtn.style.borderColor = "#00e676"; banBtn.style.color = "#00e676"; }
                else { banBtn.innerText = "–ó–ê–ë–ê–ù–ò–¢–¨"; banBtn.style.borderColor = "#ff3d00"; banBtn.style.color = "#ff3d00"; }
            });
        }

        function closeModal() {
            document.getElementById('editModal').classList.remove('open');
            if(activeListener && activePlayerId) db.ref('players/' + activePlayerId).off('value', activeListener);
            activePlayerId = null;
        }

        // ACTIONS
        function savePlayerFinance() {
            if(!activePlayerId) return;
            const bal = parseFloat(document.getElementById('ed-balance').value);
            const debt = parseFloat(document.getElementById('ed-debt').value);
            db.ref('players/' + activePlayerId).update({ balance: bal, debt: debt });
        }

        function savePlayerStats() {
            if(!activePlayerId) return;
            const e = parseInt(document.getElementById('rng-energy').value);
            const w = parseInt(document.getElementById('rng-water').value);
            const m = parseInt(document.getElementById('rng-mood').value);
            db.ref('players/' + activePlayerId + '/stats').update({ energy: e, water: w, mood: m });
            db.ref('players/' + activePlayerId + '/needs').update({ energy: e, water: w, mood: m });
        }

        function savePlayerInv() {
            if(!activePlayerId) return;
            const inv = { water: parseInt(document.getElementById('inv-water').value), bar: parseInt(document.getElementById('inv-bar').value), energy_drink: parseInt(document.getElementById('inv-energy_drink').value) };
            db.ref('players/' + activePlayerId + '/inventory').update(inv);
        }

        function toggleBan() {
            if(!activePlayerId) return;
            db.ref('players/' + activePlayerId + '/isBanned').once('value', s => db.ref('players/' + activePlayerId).update({ isBanned: !s.val() }));
        }
        
        function unlockTaxi() {
            if(!activePlayerId) return;
            db.ref('players/' + activePlayerId + '/taxi').update({ unlocked: true });
            db.ref('players/' + activePlayerId + '/adminInbox').push({ type: 'SET_VAR', path: 'taxi.unlocked', value: true });
        }

        function saveGlobalConfig() {
            const cfg = {
                basePickupPay: parseFloat(document.getElementById('cfg-basePickupPay').value),
                perKmPay: parseFloat(document.getElementById('cfg-perKmPay').value),
                payVariance: parseFloat(document.getElementById('cfg-payVariance').value),
                inflationRate: parseFloat(document.getElementById('cfg-inflationRate').value) / 100,
                tipChance: parseFloat(document.getElementById('cfg-tipChance').value),
                tipMinTemp: parseInt(document.getElementById('cfg-tipMinTemp').value),
                tipMinMood: parseInt(document.getElementById('cfg-tipMinMood').value),
                energyDrain: parseFloat(document.getElementById('cfg-energyDrain').value),
                waterDrain: parseFloat(document.getElementById('cfg-waterDrain').value),
                deliveryTime: parseInt(document.getElementById('cfg-deliveryTime').value),
                itemPrices: {
                    water: parseFloat(document.getElementById('price-water').value),
                    bar: parseFloat(document.getElementById('price-bar').value),
                    energy_drink: parseFloat(document.getElementById('price-energy_drink').value)
                }
            };
            db.ref('config').update(cfg)
                .then(() => alert('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —É –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤!'))
                .catch(e => alert('–û—à–∏–±–∫–∞: ' + e.message));
        }
    </script>
</body>
</html>
