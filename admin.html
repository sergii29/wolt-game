<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WARSZAWA GOD PANEL</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #f3f4f6; font-family: sans-serif; padding: 20px; font-size: 13px; color: #111; }
        .header { background: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; }
        .tab { background: white; padding: 10px 20px; border-radius: 8px; cursor: pointer; border: 1px solid #ddd; font-weight: bold; white-space: nowrap; }
        .tab.active { background: #2563eb; color: white; border-color: #2563eb; }
        .panel { display: none; }
        .panel.active { display: block; }
        
        .card { background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .card h3 { margin: 0 0 15px 0; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; color: #2563eb; font-size: 14px; text-transform: uppercase; }
        
        .row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; border-bottom: 1px dashed #eee; padding-bottom: 5px; }
        .row label { font-weight: 600; color: #444; }
        .row small { color: #888; display: block; font-size: 10px; }
        
        input { text-align: right; padding: 6px; border-radius: 5px; border: 1px solid #ccc; font-weight: bold; width: 100px; }
        input:focus { border-color: #2563eb; outline: none; }
        
        .btn { width: 100%; padding: 12px; background: #2563eb; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn:hover { background: #1d4ed8; }
        .btn-red { background: #ef4444; }
        
        /* Players List */
        .p-item { background: white; padding: 10px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; border-left: 4px solid #ccc; }
        .p-item.online { border-left-color: #10b981; }
        .p-item:hover { transform: translateX(5px); transition: 0.2s; }
        
        /* Modal */
        .modal-wrap { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 99; display: none; justify-content: center; align-items: center; }
        .modal { background: white; width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto; padding: 20px; border-radius: 15px; }
    </style>
</head>
<body>

<div class="header">
    <h2 style="margin:0">üëë GOD MODE <small style="font-size:12px; color:#888">v6.0</small></h2>
    <div id="status" style="font-weight:bold; color:orange">CONNECTING...</div>
</div>

<div class="tabs">
    <div class="tab active" onclick="show('players')">üë• –ò–≥—Ä–æ–∫–∏</div>
    <div class="tab" onclick="show('eco')">üí∏ –≠–∫–æ–Ω–æ–º–∏–∫–∞</div>
    <div class="tab" onclick="show('shop')">üõí –ú–∞–≥–∞–∑–∏–Ω</div>
    <div class="tab" onclick="show('taxi')">üöñ –¢–∞–∫—Å–∏ –¶–µ–Ω—ã</div>
    <div class="tab" onclick="show('rocket')">üöÄ –†–∞–∫–µ—Ç–∞</div>
</div>

<div id="players" class="panel active">
    <input type="text" id="p-search" placeholder="üîç –ü–æ–∏—Å–∫..." onkeyup="renderPlayers()" style="width:100%; padding:12px; box-sizing:border-box; margin-bottom:15px">
    <div id="p-list">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
</div>

<div id="eco" class="panel">
    <div class="card">
        <h3>–î–æ—Ö–æ–¥—ã</h3>
        <div class="row"><div><label>–ë–∞–∑–æ–≤–∞—è –ø–æ–¥–∞—á–∞</label><small>–ó–∞ —Å—Ç–∞—Ä—Ç –∑–∞–∫–∞–∑–∞</small></div><input type="number" id="basePickupPay"></div>
        <div class="row"><div><label>–û–ø–ª–∞—Ç–∞ –∑–∞ –ö–ú</label><small>–ú–Ω–æ–∂–∏—Ç–µ–ª—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è</small></div><input type="number" id="perKmPay"></div>
        <div class="row"><div><label>–ú–Ω–æ–∂–∏—Ç–µ–ª—å –¢–ê–ö–°–ò</label><small>–í–æ —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —Ç–∞–∫—Å–∏ –¥–æ—Ä–æ–∂–µ</small></div><input type="number" id="taxiMulti"></div>
        <div class="row"><div><label>–†–∞–∑–±—Ä–æ—Å —Ü–µ–Ω—ã (+/-)</label><small>–†–∞–Ω–¥–æ–º–Ω–æ—Å—Ç—å –∑–∞—Ä–∞–±–æ—Ç–∫–∞</small></div><input type="number" id="payVariance"></div>
    </div>
    <div class="card">
        <h3>–ë–∞–Ω–∫ –∏ –°–ª–æ–∂–Ω–æ—Å—Ç—å</h3>
        <div class="row"><div><label>–ö—Ä–µ–¥–∏—Ç (–°—Ç–∞—Ä—Ç)</label><small>–õ–∏–º–∏—Ç –¥–ª—è –Ω–æ–≤–∏—á–∫–∞</small></div><input type="number" id="bankLimitBase"></div>
        <div class="row"><div><label>–î–æ–≤–µ—Ä–∏–µ –∑–∞ –∑–∞–∫–∞–∑</label><small>–†–æ—Å—Ç –ª–∏–º–∏—Ç–∞</small></div><input type="number" id="bankLimitMulti"></div>
        <div class="row"><div><label>–¢—Ä–∞—Ç–∞ –≠–Ω–µ—Ä–≥–∏–∏</label><small>–ó–∞ –æ–¥–∏–Ω –∫–ª–∏–∫</small></div><input type="number" id="energyDrain" step="0.01"></div>
        <div class="row"><div><label>–¢—Ä–∞—Ç–∞ –í–æ–¥—ã</label><small>–ó–∞ –æ–¥–∏–Ω –∫–ª–∏–∫</small></div><input type="number" id="waterDrain" step="0.01"></div>
        <div class="row"><div><label>–ò–Ω—Ñ–ª—è—Ü–∏—è (%)</label><small>–£–¥–æ—Ä–æ–∂–∞–Ω–∏–µ –∑–∞ –ø–æ–ª–æ–º–∫—É</small></div><input type="number" id="inflationRate"></div>
    </div>
    <button class="btn" onclick="saveAll()">–°–û–•–†–ê–ù–ò–¢–¨ –ù–ê–°–¢–†–û–ô–ö–ò</button>
</div>

<div id="shop" class="panel">
    <div class="card">
        <h3>–¢–æ–≤–∞—Ä—ã (–ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞)</h3>
        <div class="row"><div><label>–í–æ–¥–∞</label></div><input type="number" id="price_water"></div>
        <div class="row"><div><label>–°–Ω–∏–∫–µ—Ä—Å (Bar)</label></div><input type="number" id="price_bar"></div>
        <div class="row"><div><label>RedBull</label></div><input type="number" id="price_energy"></div>
        <div class="row"><div><label>–ö–æ—Ñ–µ</label></div><input type="number" id="price_coffee"></div>
        <div class="row"><div><label>–ë–µ–Ω–∑–∏–Ω</label></div><input type="number" id="price_gas"></div>
    </div>
    <div class="card">
        <h3>–°–µ—Ä–≤–∏—Å (–ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞)</h3>
        <div class="row"><div><label>–†–µ–º–æ–Ω—Ç –í–µ–ª–æ—Å–∏–ø–µ–¥–∞</label></div><input type="number" id="price_rep_bike"></div>
        <div class="row"><div><label>–†–µ–º–æ–Ω—Ç –°—É–º–∫–∏</label></div><input type="number" id="price_rep_bag"></div>
        <div class="row"><div><label>–°–≤—è–∑—å (–¢–µ–ª–µ—Ñ–æ–Ω)</label></div><input type="number" id="price_rep_phone"></div>
        <div class="row"><div><label>–û–¥–µ–∂–¥–∞ / –®–∏–Ω—ã</label></div><input type="number" id="price_rep_gear"></div>
    </div>
    <button class="btn" onclick="saveAll()">–û–ë–ù–û–í–ò–¢–¨ –¶–ï–ù–ù–ò–ö–ò</button>
</div>

<div id="taxi" class="panel">
    <div class="card">
        <h3>–ê–≤—Ç–æ–º–æ–±–∏–ª–∏</h3>
        <div class="row"><div><label>Skoda Fabia</label></div><input type="number" id="car_skoda"></div>
        <div class="row"><div><label>Toyota Prius</label></div><input type="number" id="car_toyota"></div>
        <div class="row"><div><label>Tesla Model 3</label></div><input type="number" id="car_tesla"></div>
    </div>
    <div class="card">
        <h3>–î–æ–∫—É–º–µ–Ω—Ç—ã</h3>
        <div class="row"><div><label>–ü—Ä–∞–≤–∞ (B)</label></div><input type="number" id="lic_driver"></div>
        <div class="row"><div><label>–°—Ç—Ä–∞—Ö–æ–≤–∫–∞</label></div><input type="number" id="lic_ins"></div>
        <div class="row"><div><label>–õ–∏—Ü–µ–Ω–∑–∏—è</label></div><input type="number" id="lic_taxi"></div>
    </div>
    <button class="btn" onclick="saveAll()">–°–û–•–†–ê–ù–ò–¢–¨ –ê–í–¢–û–°–ê–õ–û–ù</button>
</div>

<div id="rocket" class="panel">
    <div class="card">
        <h3>–ê–∫—Ç–∏–≤–Ω—ã–µ –¶–µ–ª–∏</h3>
        <div id="rocket-list"></div>
        <button class="btn" style="background:#444; margin-top:10px" onclick="addRocket()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
    </div>
    <button class="btn" onclick="pushRocket()">üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨ –†–ê–ö–ï–¢–£</button>
</div>

<div class="modal-wrap" id="modal">
    <div class="modal">
        <h2 id="pm-name">–ò–≥—Ä–æ–∫</h2>
        <div class="card">
            <h3>–ë–∞–ª–∞–Ω—Å</h3>
            <div class="row"><label>–î–µ–Ω—å–≥–∏</label><input type="number" id="pm-bal"></div>
            <div class="row"><label>–î–æ–ª–≥</label><input type="number" id="pm-debt"></div>
        </div>
        <div class="card">
            <h3>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h3>
            <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:5px">
                <input type="number" id="pm-i-w" placeholder="–í–æ–¥–∞"><input type="number" id="pm-i-b" placeholder="–ï–¥–∞"><input type="number" id="pm-i-e" placeholder="RedBull">
                <input type="number" id="pm-i-c" placeholder="–ö–æ—Ñ–µ"><input type="number" id="pm-i-g" placeholder="–ë–µ–Ω–∑">
            </div>
        </div>
        <div style="display:flex; gap:10px">
            <button class="btn" style="background:#f59e0b; color:black" onclick="giveTaxi()">üéÅ –î–ê–¢–¨ –¢–ê–ö–°–ò (FREE)</button>
            <button class="btn btn-red" onclick="banUser()">BAN</button>
        </div>
        <button class="btn" onclick="saveUser()">–°–û–•–†–ê–ù–ò–¢–¨</button>
        <button class="btn" style="background:#ccc; color:#000" onclick="document.getElementById('modal').style.display='none'">–ó–ê–ö–†–´–¢–¨</button>
    </div>
</div>

<script>
    const fb = { apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk", authDomain: "warszawa-courier.firebaseapp.com", databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app", projectId: "warszawa-courier", storageBucket: "warszawa-courier.firebasestorage.app", messagingSenderId: "295860613508", appId: "1:295860613508:web:86fe8364377d6875612dd1" };
    firebase.initializeApp(fb);
    const db = firebase.database();
    
    let players = {}, activeId = null, rockets = [];

    db.ref('.info/connected').on('value', s => document.getElementById('status').innerText = s.val() ? 'ONLINE' : 'OFFLINE');

    // –ß–∏—Ç–∞–µ–º –ò–≥—Ä–æ–∫–æ–≤
    db.ref('players').on('value', s => { players = s.val() || {}; renderPlayers(); });

    // –ß–∏—Ç–∞–µ–º –ö–æ–Ω—Ñ–∏–≥
    db.ref('config').on('value', s => {
        const c = s.val() || {};
        const set = (id, v) => { if(document.getElementById(id)) document.getElementById(id).value = v; };
        
        // Eco
        set('basePickupPay', c.basePickupPay||4); set('perKmPay', c.perKmPay||1.5); set('taxiMulti', c.taxiMulti||4);
        set('bankLimitBase', c.bankLimitBase||1000); set('bankLimitMulti', c.bankLimitMulti||50);
        set('energyDrain', c.energyDrain||0.15); set('waterDrain', c.waterDrain||0.1); set('inflationRate', (c.inflationRate||0.1)*100);
        set('payVariance', c.payVariance||2);

        // Shop
        const p = c.itemPrices || {};
        set('price_water', p.water||2); set('price_bar', p.bar||4.5); set('price_energy', p.energy_drink||7);
        set('price_coffee', p.coffee||9); set('price_gas', p.gas||12);
        set('price_rep_bike', p.repair_bike||5); set('price_rep_bag', p.repair_bag||2);
        set('price_rep_phone', p.repair_phone||1); set('price_rep_gear', p.repair_gear||3);

        // Cars & Lic
        set('car_skoda', p.car_skoda||15000); set('car_toyota', p.car_toyota||45000); set('car_tesla', p.car_tesla||120000);
        set('lic_driver', p.lic_driver||2500); set('lic_ins', p.lic_insurance||1200); set('lic_taxi', p.lic_taxi||5000);
    });

    // –ß–∏—Ç–∞–µ–º –†–∞–∫–µ—Ç—É
    db.ref('bonuses/active').on('value', s => { rockets = s.val() || []; renderRockets(); });

    function renderPlayers() {
        const c = document.getElementById('p-list'); c.innerHTML = '';
        const search = document.getElementById('p-search').value.toLowerCase();
        
        Object.entries(players).forEach(([id, p]) => {
            if((p.name||'').toLowerCase().includes(search) || id.includes(search)) {
                const online = (Date.now() - (p.lastSeen||0) < 20000);
                c.innerHTML += `<div class="p-item ${online?'online':''}" onclick="edit('${id}')">
                    <div><b>${p.name||'Guest'}</b><br><small>${id}</small></div>
                    <div style="text-align:right"><b>${(p.balance||0).toFixed(2)} PLN</b><br><small>${online?'ONLINE':'OFFLINE'}</small></div>
                </div>`;
            }
        });
    }

    function edit(id) {
        activeId = id; const p = players[id];
        document.getElementById('modal').style.display = 'flex';
        document.getElementById('pm-name').innerText = p.name;
        document.getElementById('pm-bal').value = p.balance||0;
        document.getElementById('pm-debt').value = p.debt||0;
        const i = p.inventory || {};
        document.getElementById('pm-i-w').value = i.water||0;
        document.getElementById('pm-i-b').value = i.bar||0;
        document.getElementById('pm-i-e').value = i.energy_drink||0;
        document.getElementById('pm-i-c').value = i.coffee||0;
        document.getElementById('pm-i-g').value = i.gas||0;
    }

    function saveUser() {
        if(!activeId) return;
        db.ref('players/'+activeId).update({
            balance: parseFloat(document.getElementById('pm-bal').value),
            debt: parseFloat(document.getElementById('pm-debt').value),
            'inventory/water': parseInt(document.getElementById('pm-i-w').value),
            'inventory/bar': parseInt(document.getElementById('pm-i-b').value),
            'inventory/energy_drink': parseInt(document.getElementById('pm-i-e').value),
            'inventory/coffee': parseInt(document.getElementById('pm-i-c').value),
            'inventory/gas': parseInt(document.getElementById('pm-i-g').value),
        }).then(()=>alert('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!'));
    }

    function giveTaxi() {
        if(confirm('–í—ã–¥–∞—Ç—å Tesla –∏ –≤—Å–µ –ø—Ä–∞–≤–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ?')) {
            db.ref('players/'+activeId+'/taxi').update({ unlocked:true, vehicle:'tesla', licenses:{driver:true, insurance:true, taxi:true} });
            alert('–í—ã–¥–∞–Ω–æ!');
        }
    }

    function saveAll() {
        const get = (id) => parseFloat(document.getElementById(id).value);
        const data = {
            basePickupPay: get('basePickupPay'), perKmPay: get('perKmPay'), taxiMulti: get('taxiMulti'), payVariance: get('payVariance'),
            bankLimitBase: get('bankLimitBase'), bankLimitMulti: get('bankLimitMulti'),
            energyDrain: get('energyDrain'), waterDrain: get('waterDrain'), inflationRate: get('inflationRate')/100,
            itemPrices: {
                water: get('price_water'), bar: get('price_bar'), energy_drink: get('price_energy'), coffee: get('price_coffee'), gas: get('price_gas'),
                repair_bike: get('price_rep_bike'), repair_bag: get('price_rep_bag'), repair_phone: get('price_rep_phone'), repair_gear: get('price_rep_gear'),
                car_skoda: get('car_skoda'), car_toyota: get('car_toyota'), car_tesla: get('car_tesla'),
                lic_driver: get('lic_driver'), lic_insurance: get('lic_ins'), lic_taxi: get('lic_taxi')
            }
        };
        db.ref('config').update(data).then(()=>alert('–í–°–ï –¶–ï–ù–´ –û–ë–ù–û–í–õ–ï–ù–´!'));
    }

    // Rocket Logic
    function renderRockets() {
        const c = document.getElementById('rocket-list'); c.innerHTML = '';
        rockets.forEach((r, i) => {
            c.innerHTML += `<div style="background:#eee; padding:10px; margin-bottom:5px; border-radius:5px; display:flex; gap:5px">
                <input class="rk-t" value="${r.title}" placeholder="–¢–µ–∫—Å—Ç" style="flex:2">
                <input class="rk-r" value="${r.reward}" placeholder="–ù–∞–≥—Ä–∞–¥–∞" type="number">
                <input class="rk-g" value="${r.target}" placeholder="–¶–µ–ª—å" type="number">
                <input class="rk-m" value="${Math.floor((r.endTime-Date.now())/60000)}" placeholder="–ú–∏–Ω" type="number">
                <button onclick="rockets.splice(${i},1);renderRockets()" style="background:red; border:none; color:white; border-radius:5px">X</button>
            </div>`;
        });
    }
    function addRocket() { rockets.push({title:"–ë–æ–Ω—É—Å", reward:100, target:10, endTime:Date.now()+3600000}); renderRockets(); }
    function pushRocket() {
        const data = [];
        document.querySelectorAll('#rocket-list > div').forEach((row, i) => {
            data.push({
                id: i+1,
                title: row.querySelector('.rk-t').value,
                reward: parseFloat(row.querySelector('.rk-r').value),
                target: parseInt(row.querySelector('.rk-g').value),
                endTime: Date.now() + (parseInt(row.querySelector('.rk-m').value)*60000)
            });
        });
        db.ref('bonuses/active').set(data).then(()=>alert('–†–∞–∫–µ—Ç–∞ —É–ª–µ—Ç–µ–ª–∞!'));
    }

    function show(id) {
        document.querySelectorAll('.panel').forEach(e=>e.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(e=>e.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        event.target.classList.add('active');
    }
</script>
</body>
</html>
