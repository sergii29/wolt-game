<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ê–¥–º–∏–Ω–∫–∞ ‚Ä¢ –†–µ–∂–∏–º –ë–æ–≥–∞</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="database.js"></script>

<style>
:root{
  --bg:#0b0e13;
  --card:#141922;
  --border:#1f2633;
  --accent:#4da3ff;
  --ok:#3ddc84;
  --bad:#ff5c5c;
  --text:#e8ecf1;
  --muted:#9aa4b2;
}
*{box-sizing:border-box}
body{
  margin:0;
  padding:12px;
  background:var(--bg);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
}
.section{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  padding:14px;
  margin-bottom:16px;
}
.section h2{
  margin:0 0 12px;
  font-size:18px;
}
label{
  font-size:13px;
  color:var(--muted);
}
input,select,button{
  width:100%;
  padding:10px;
  margin-top:6px;
  margin-bottom:10px;
  background:#0f1420;
  color:var(--text);
  border:1px solid var(--border);
  border-radius:10px;
  font-size:15px;
}
button{
  background:linear-gradient(180deg,#2a7cff,#1f5fcc);
  border:none;
  font-weight:600;
}
button.secondary{
  background:#20283a;
}
.row{display:flex;gap:10px}
.row>div{flex:1}
.status{font-size:14px;margin-bottom:10px}
.online{color:var(--ok)}
.offline{color:var(--bad)}
.readonly{
  background:#0c111c;
  color:var(--muted);
}
small{color:var(--muted)}
</style>
</head>

<body>

<!-- –ò–ì–†–û–ö–ò -->
<div class="section">
<h2>üë§ –ò–≥—Ä–æ–∫–∏</h2>

<label>–ò–≥—Ä–æ–∫</label>
<select id="playerSelect"></select>

<div id="playerStatus" class="status"></div>

<label>–ë–∞–ª–∞–Ω—Å (PLN)</label>
<input id="pBalance" type="number">

<label>–≠–Ω–µ—Ä–≥–∏—è</label>
<input id="pEnergy" type="number">

<label>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</label>
<input id="pMood" type="number">

<button onclick="savePlayer()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä–æ–∫–∞</button>
</div>

<!-- –≠–ö–û–ù–û–ú–ò–ö–ê -->
<div class="section">
<h2>üåç –≠–∫–æ–Ω–æ–º–∏–∫–∞ (–∞–≤—Ç–æ-–∏–Ω—Ñ–ª—è—Ü–∏—è)</h2>

<label>–¢–µ–∫—É—â–∞—è –∏–Ω—Ñ–ª—è—Ü–∏—è (%)</label>
<input id="currentInflation" class="readonly" disabled>

<label>–ò–Ω–¥–µ–∫—Å —ç–∫–æ–Ω–æ–º–∏–∫–∏</label>
<input id="economyIndex" class="readonly" disabled>

<label>–ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–ª—è—Ü–∏—è (%)</label>
<input id="baseInflation" type="number">

<label>–ú–Ω–æ–∂–∏—Ç–µ–ª—å –∏–Ω–¥–µ–∫—Å–∞</label>
<input id="indexMultiplier" type="number" step="0.01">

<label>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–ª—è—Ü–∏—è (%)</label>
<input id="maxInflation" type="number">

<label>
  <input type="checkbox" id="autoInflation">
  –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–ª—è—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞
</label>

<button onclick="saveEconomy()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç–∫–æ–Ω–æ–º–∏–∫—É</button>
</div>

<!-- –î–û–°–¢–ê–í–ö–ê -->
<div class="section">
<h2>üö¥ –¢–∞—Ä–∏—Ñ—ã –¥–æ—Å—Ç–∞–≤–∫–∏</h2>

<label>–ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞</label>
<input id="delBase" type="number">

<label>–¶–µ–Ω–∞ –∑–∞ –∫–∏–ª–æ–º–µ—Ç—Ä</label>
<input id="delKm" type="number">

<button onclick="saveDelivery()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–∞—Ä–∏—Ñ—ã</button>
</div>

<!-- –¶–ï–õ–ò -->
<div class="section">
<h2>üéØ –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</h2>

<div class="row">
  <div>
    <label>–ú–∏–Ω—É—Ç—ã</label>
    <input id="goalMin" type="number">
  </div>
  <div>
    <label>–°–µ–∫—É–Ω–¥—ã</label>
    <input id="goalSec" type="number">
  </div>
</div>

<label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç–∞–≤–æ–∫</label>
<input id="goalCount" type="number">

<label>–ë–æ–Ω—É—Å (PLN)</label>
<input id="goalBonus" type="number">

<small>–ü—Ä–∏–º–µ—Ä: 100 –¥–æ—Å—Ç–∞–≤–æ–∫ –∑–∞ 1:05 ‚Üí –º–∏–Ω—É—Ç—ã 65, —Å–µ–∫—É–Ω–¥—ã 0</small>

<button onclick="saveGoal()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–µ–ª—å</button>
</div>

<script>
let currentPlayer=null;

/* === –ò–ì–†–û–ö–ò === */
db.ref("players").on("value",snap=>{
  playerSelect.innerHTML="";
  snap.forEach(p=>{
    const o=document.createElement("option");
    o.value=p.key;o.textContent=p.key;
    playerSelect.appendChild(o);
  });
  if(playerSelect.value) loadPlayer();
});
playerSelect.onchange=loadPlayer;

function loadPlayer(){
  currentPlayer=playerSelect.value;
  db.ref("players/"+currentPlayer).once("value").then(s=>{
    const d=s.val()||{};
    pBalance.value=d.balance||0;
    pEnergy.value=d.energy||0;
    pMood.value=d.mood||0;
    playerStatus.innerHTML=d.online
      ? "–°—Ç–∞—Ç—É—Å: <span class='online'>–æ–Ω–ª–∞–π–Ω</span>"
      : "–°—Ç–∞—Ç—É—Å: <span class='offline'>–æ—Ñ—Ñ–ª–∞–π–Ω</span>";
  });
}
function savePlayer(){
  db.ref("players/"+currentPlayer).update({
    balance:+pBalance.value,
    energy:+pEnergy.value,
    mood:+pMood.value
  });
}

/* === –≠–ö–û–ù–û–ú–ò–ö–ê === */
db.ref("economy").on("value",s=>{
  const d=s.val()||{};
  currentInflation.value=d.currentInflation ?? 0;
  economyIndex.value=d.economyIndex ?? 0;
  baseInflation.value=d.baseInflation ?? 0;
  indexMultiplier.value=d.indexMultiplier ?? 0;
  maxInflation.value=d.maxInflation ?? 0;
  autoInflation.checked=!!d.autoInflation;
});
function saveEconomy(){
  db.ref("economy").update({
    baseInflation:+baseInflation.value,
    indexMultiplier:+indexMultiplier.value,
    maxInflation:+maxInflation.value,
    autoInflation:autoInflation.checked
  });
}

/* === –î–û–°–¢–ê–í–ö–ê === */
db.ref("delivery").once("value").then(s=>{
  delBase.value=s.val()?.basePrice ?? 0;
  delKm.value=s.val()?.pricePerKm ?? 0;
});
function saveDelivery(){
  db.ref("delivery").update({
    basePrice:+delBase.value,
    pricePerKm:+delKm.value
  });
}

/* === –¶–ï–õ–ò === */
db.ref("goals/daily").once("value").then(s=>{
  if(!s.val()) return;
  goalMin.value=Math.floor(s.val().timeSeconds/60);
  goalSec.value=s.val().timeSeconds%60;
  goalCount.value=s.val().deliveries;
  goalBonus.value=s.val().bonus;
});
function saveGoal(){
  const seconds=(+goalMin.value*60)+(+goalSec.value);
  db.ref("goals/daily").set({
    timeSeconds:seconds,
    deliveries:+goalCount.value,
    bonus:+goalBonus.value
  });
}
</script>

</body>
</html>
