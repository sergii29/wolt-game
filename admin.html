<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WOLT GOD MODE | Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

    <style>
        :root { --bg: #121212; --panel: #1e1e1e; --border: #333; --text: #e0e0e0; --accent: #00e676; --danger: #ff3d00; --info: #2979ff; --warn: #ffea00; }
        body { margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); height: 100vh; display: flex; overflow: hidden; }
        .sidebar { width: 350px; background: var(--panel); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
        .search-box { padding: 15px; border-bottom: 1px solid var(--border); }
        .search-input { width: 100%; padding: 10px; background: #2c2c2c; border: 1px solid #444; color: white; border-radius: 6px; box-sizing: border-box; }
        .nav-bar { display: flex; border-bottom: 1px solid var(--border); background: #1a1a1a; }
        .nav-btn { flex: 1; padding: 10px; background: transparent; border: none; color: #666; cursor: pointer; font-size: 14px; transition: 0.2s; border-bottom: 2px solid transparent; }
        .nav-btn:hover { color: white; background: #252525; }
        .nav-btn.active { color: var(--accent); border-bottom-color: var(--accent); }
        .player-list { flex: 1; overflow-y: auto; }
        .player-item { padding: 15px; border-bottom: 1px solid var(--border); cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: space-between; }
        .player-item:hover { background: #252525; }
        .player-item.active { background: #2c3e50; border-left: 4px solid var(--info); }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; background: #555; display: inline-block; margin-right: 5px; }
        .online .status-dot { background: var(--accent); box-shadow: 0 0 5px var(--accent); }
        .main { flex: 1; padding: 30px; overflow-y: auto; display: none; }
        .main.visible { display: block; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 1px solid var(--border); padding-bottom: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .card { background: var(--panel); padding: 20px; border-radius: 12px; border: 1px solid var(--border); }
        .card h3 { margin-top: 0; border-bottom: 1px solid #333; padding-bottom: 10px; color: #aaa; font-size: 14px; text-transform: uppercase; }
        .stat-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px; }
        .val { font-weight: bold; color: white; }
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        button { padding: 10px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; color: white; transition: 0.2s; }
        button:hover { filter: brightness(1.2); }
        .btn-money { background: #00695c; } .btn-heal { background: #1565c0; } .btn-item { background: #6a1b9a; }
        .btn-danger { background: #c62828; } .btn-warn { background: #f57f17; color: black; }
        .btn-save { background: var(--accent); color: black; width: 100%; margin-top: 10px; }
        .config-input { width: 100%; background: #222; border: 1px solid #444; color: white; padding: 8px; border-radius: 5px; margin-bottom: 10px; }
        .config-label { font-size: 12px; color: #888; margin-bottom: 4px; display: block; }
        .prices-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .price-item { background: #252525; padding: 10px; border-radius: 6px; border: 1px solid #333; }
        .log-entry { padding: 8px; border-bottom: 1px solid #333; font-size: 12px; font-family: monospace; display: flex; gap: 10px; }
        .log-user { color: var(--accent); font-weight: bold; min-width: 100px; }
        .log-msg { color: #ccc; }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="search-box"><input type="text" id="search" class="search-input" placeholder="üîç –ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞..." onkeyup="renderList()"></div>
        <div class="nav-bar">
            <button class="nav-btn active" onclick="showView('players', this)"><i class="fa-solid fa-user"></i> –ò–≥—Ä–æ–∫–∏</button>
            <button class="nav-btn" onclick="showView('config', this)"><i class="fa-solid fa-sliders"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <button class="nav-btn" onclick="showView('logs', this)"><i class="fa-solid fa-list"></i> –õ–æ–≥–∏</button>
        </div>
        <div id="list-container" class="player-list"><div style="padding:20px; text-align:center; color:#666">–ó–∞–≥—Ä—É–∑–∫–∞...</div></div>
        <div style="padding:10px; font-size:11px; text-align:center; color:#444">WARSZAWA_FOREVER ADMIN v4.0</div>
    </div>

    <div id="view-players" class="main visible">
        <div id="empty-state" style="flex:1; display:flex; align-items:center; justify-content:center; color:#444; font-size:20px;">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ —Å–ª–µ–≤–∞</div>
        <div id="player-panel" style="display:none">
            <div class="header">
                <div class="user-title">
                    <h1 id="p-name">Name</h1>
                    <span id="p-id" style="color:#666; font-family:monospace">ID: ...</span>
                </div>
                <div style="text-align:right">
                    <div style="font-size:30px; color:var(--accent)" id="p-balance">0.00 PLN</div>
                    <div style="font-size:12px; color:#888">–ë–∞–ª–∞–Ω—Å</div>
                </div>
            </div>
            <div class="grid">
                <div class="card">
                    <h3>üí∞ –§–∏–Ω–∞–Ω—Å—ã</h3>
                    <div class="stat-row"><span>–¢–µ–∫—É—â–∏–π:</span> <span class="val" id="val-bal">0</span></div>
                    <div class="stat-row"><span>–î–æ–ª–≥:</span> <span class="val" id="val-debt" style="color:red">0</span></div>
                    <div class="controls">
                        <button class="btn-money" onclick="modBalance(1000)">+1K PLN</button>
                        <button class="btn-money" onclick="modBalance(10000)">+10K PLN</button>
                        <button class="btn-warn" onclick="modBalance(-1000)">-1000 (–®—Ç—Ä–∞—Ñ)</button>
                        <button class="btn-money" style="background:#2e7d32" onclick="clearDebt()">–°–Ω—è—Ç—å –¥–æ–ª–≥</button>
                    </div>
                </div>
                <div class="card">
                    <h3>‚ù§Ô∏è –°–æ—Å—Ç–æ—è–Ω–∏–µ</h3>
                    <div class="stat-row"><span>–≠–Ω–µ—Ä–≥–∏—è/–í–æ–¥–∞/–ù–∞—Å—Ç—Ä:</span> <span class="val" id="val-needs">0/0/0</span></div>
                    <div class="controls">
                        <button class="btn-heal" onclick="setStat('needs', {energy:100, water:100, mood:100})">–í–´–õ–ï–ß–ò–¢–¨ –í–°–Å</button>
                        <button class="btn-heal" style="background:#0277bd" onclick="killStats()">–£–±–∏—Ç—å (1%)</button>
                    </div>
                </div>
                <div class="card">
                    <h3>üöñ –¢–∞–∫—Å–∏ / Cyber</h3>
                    <div class="stat-row"><span>–ê–≤—Ç–æ:</span> <span class="val" id="val-car">–ù–µ—Ç</span></div>
                    <div class="stat-row"><span>–°–±–æ—Ä–∫–∞:</span> <span class="val" id="val-assembled">–ù–ï–¢</span></div>
                    <div class="controls">
                        <button class="btn-item" style="background:#d500f9" onclick="giveCyberCar()">üéÅ –í—ã–¥–∞—Ç—å –ê–≤—Ç–æ (–ß–∏—Ç)</button>
                        <button class="btn-item" style="background:#00e676; color:black; grid-column: span 2;" onclick="giveTaxiParts()">üîß –í—ã–¥–∞—Ç—å –¥–µ—Ç–∞–ª–∏ (–°–±–æ—Ä–∫–∞)</button>
                        <button class="btn-item" style="background:#ff3d00" onclick="resetCar()">üóë –°–±—Ä–æ—Å –º–∞—à–∏–Ω—ã</button>
                    </div>
                </div>
                <div class="card" style="border-color: var(--danger)">
                    <h3 style="color:var(--danger)">‚ò†Ô∏è –ê–∫–∫–∞—É–Ω—Ç</h3>
                    <div class="stat-row"><span>–ë–∞–Ω:</span> <span class="val" id="val-banned">–ù–ï–¢</span></div>
                    <div class="controls">
                        <button class="btn-danger" onclick="toggleBan()">–ë–ê–ù / –†–ê–ó–ë–ê–ù</button>
                        <button class="btn-danger" style="background:#b71c1c" onclick="fullReset()">–°–ë–†–û–°–ò–¢–¨ (WIPE)</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="view-config" class="main">
        <h1 style="color:var(--warn)">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h1>
        <div class="grid">
            <div class="card">
                <h3>üíµ –¢–∞—Ä–∏—Ñ—ã</h3>
                <label class="config-label">–ë–∞–∑–æ–≤–∞—è –ø–æ–¥–∞—á–∞</label><input type="number" id="cfg-basePickupPay" class="config-input">
                <label class="config-label">–ó–∞ –ö–ú</label><input type="number" id="cfg-perKmPay" class="config-input">
                <label class="config-label">–ò–Ω—Ñ–ª—è—Ü–∏—è</label><input type="number" id="cfg-inflationRate" class="config-input">
            </div>
            <div class="card" style="grid-column: span 2">
                <h3>üè∑ –¶–µ–Ω—ã</h3>
                <div id="prices-container" class="prices-grid"></div>
                <button class="btn-save" onclick="saveConfig()">üíæ –°–û–•–†–ê–ù–ò–¢–¨</button>
            </div>
        </div>
    </div>

    <div id="view-logs" class="main">
        <div style="display:flex; justify-content:space-between;"><h1>üìú –õ–æ–≥–∏</h1><button class="btn-item" style="width:auto" onclick="loadLogs()">–û–±–Ω–æ–≤–∏—Ç—å</button></div>
        <div id="logs-container" style="background:#1a1a1a; padding:10px; border-radius:10px; height:80vh; overflow-y:auto;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

<script>
    const firebaseConfig = { apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk", authDomain: "warszawa-courier.firebaseapp.com", databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app", projectId: "warszawa-courier", storageBucket: "warszawa-courier.firebasestorage.app", messagingSenderId: "295860613508", appId: "1:295860613508:web:86fe8364377d6875612dd1" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let allPlayers = {}, selectedId = null;
    const ITEM_NAMES = { "water": "–í–æ–¥–∞", "bar": "–°–Ω–∏–∫–µ—Ä—Å", "gas": "–ë–µ–Ω–∑–∏–Ω", "part_engine": "–î–≤–∏–≥–∞—Ç–µ–ª—å", "part_chip": "–ß–∏–ø" };
    const ALL_ITEM_KEYS = ["water", "bar", "energy_drink", "coffee", "chocolate", "gas", "repair_bike", "repair_bag", "repair_gear", "repair_phone", "lic_driver", "lic_insurance", "lic_taxi"];

    function showView(viewId, btn) {
        document.getElementById('view-players').style.display = 'none'; document.getElementById('view-config').style.display = 'none'; document.getElementById('view-logs').style.display = 'none';
        document.getElementById('view-' + viewId).style.display = 'block';
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active');
        if(viewId === 'config') loadConfig(); if(viewId === 'logs') loadLogs();
    }

    db.ref('players').on('value', snap => { allPlayers = snap.val() || {}; if(document.getElementById('view-players').style.display !== 'none') renderList(); if(selectedId) renderMain(selectedId); });

    function renderList() {
        const container = document.getElementById('list-container'); const search = document.getElementById('search').value.toLowerCase(); let html = '';
        Object.keys(allPlayers).forEach(id => {
            const p = allPlayers[id]; const name = p.name || '–ë–µ–∑ –∏–º–µ–Ω–∏';
            if (!name.toLowerCase().includes(search)) return;
            const statusClass = (Date.now() - (p.lastSeen || 0)) < 60000 ? 'online' : '';
            html += `<div class="player-item ${statusClass} ${id === selectedId ? 'active' : ''}" onclick="selectPlayer('${id}')"><div class="p-info"><h3><span class="status-dot"></span> ${name}</h3></div></div>`;
        });
        container.innerHTML = html;
    }
    function selectPlayer(id) { selectedId = id; document.getElementById('empty-state').style.display = 'none'; document.getElementById('player-panel').style.display = 'block'; renderMain(id); }
    function renderMain(id) {
        const p = allPlayers[id]; if(!p) return;
        document.getElementById('p-name').textContent = p.name; document.getElementById('p-id').textContent = id; document.getElementById('p-balance').textContent = (p.balance || 0).toFixed(2) + ' PLN';
        document.getElementById('val-bal').textContent = (p.balance || 0).toFixed(2); document.getElementById('val-debt').textContent = (p.debt || 0).toFixed(2);
        document.getElementById('val-needs').textContent = `${Math.floor(p.stats?.energy||0)} / ${Math.floor(p.stats?.water||0)} / ${Math.floor(p.stats?.mood||0)}`;
        document.getElementById('val-car').textContent = p.taxi?.vehicle || '–ù–µ—Ç';
        document.getElementById('val-assembled').textContent = p.taxi?.isCarAssembled ? '–î–ê' : '–ù–ï–¢';
        document.getElementById('val-banned').textContent = p.isBanned ? '–î–ê' : '–ù–µ—Ç';
    }

    function sendCmd(type, data) { if(!selectedId) return; db.ref('players/' + selectedId + '/adminInbox').push({ type: type, ...data }); }
    function modBalance(amount) { sendCmd('SET_VAR', { path: 'balance', value: (allPlayers[selectedId].balance||0) + amount }); }
    function clearDebt() { sendCmd('SET_VAR', { path: 'debt', value: 0 }); sendCmd('SET_VAR', { path: 'debtOverdue', value: false }); }
    function setStat(cat, values) { for (let [k, v] of Object.entries(values)) sendCmd('SET_VAR', { path: `${cat}.${k}`, value: v }); }
    function killStats() { setStat('needs', { energy: 1, water: 1, mood: 1 }); }
    function giveCyberCar() { sendCmd('SET_VAR', { path: 'taxi.vehicle', value: 'cyber_x' }); sendCmd('SET_VAR', { path: 'taxi.active', value: true }); alert('–í—ã–¥–∞–Ω–æ –∞–≤—Ç–æ'); }
    
    // –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –í–´–î–ê–ß–ò –î–ï–¢–ê–õ–ï–ô (–ö–û–¢–û–†–£–Æ –¢–´ –ü–†–û–°–ò–õ)
    function giveTaxiParts() {
        if(!selectedId) return;
        sendCmd('SET_VAR', { path: 'inventory.part_engine', value: 1 });
        sendCmd('SET_VAR', { path: 'inventory.part_chip', value: 1 });
        sendCmd('SET_VAR', { path: 'inventory.part_alloy', value: 1 });
        sendCmd('SET_VAR', { path: 'inventory.part_tire', value: 4 });
        sendCmd('SET_VAR', { path: 'inventory.fuel_canister', value: 10 });
        sendCmd('SET_VAR', { path: 'totalDeliveries', value: 55 });
        sendCmd('SET_VAR', { path: 'taxi.isCarAssembled', value: false });
        alert('–î–µ—Ç–∞–ª–∏ –∏ –æ–ø—ã—Ç (55) –≤—ã–¥–∞–Ω—ã!');
    }
    
    function resetCar() { sendCmd('SET_VAR', { path: 'taxi.vehicle', value: null }); sendCmd('SET_VAR', { path: 'taxi.isCarAssembled', value: false }); }
    function toggleBan() { sendCmd('SET_VAR', { path: 'isBanned', value: !allPlayers[selectedId].isBanned }); }
    function fullReset() { if(confirm('RESET?')) sendCmd('FULL_RESET', {}); }

    function loadConfig() { /* ... (–æ—Å—Ç–∞–≤—å –∫–∞–∫ –±—ã–ª–æ –∏–ª–∏ —É–ø—Ä–æ—Å—Ç–∏) ... */ }
    function saveConfig() { /* ... */ }
    function loadLogs() { /* ... */ }
    showView('players', document.querySelector('.nav-btn'));
</script>
</body>
</html>
