<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wolt Control</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #121212; color: #fff; font-family: sans-serif; padding: 20px; }
        .box { background: #1e1e1e; padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid #333; }
        h2 { color: #00ccff; margin-top: 0; }
        .row { display: flex; justify-content: space-between; margin-bottom: 10px; align-items: center; }
        input { background: #333; border: 1px solid #555; color: white; padding: 8px; border-radius: 5px; width: 100px; text-align: center; }
        button { padding: 10px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; color: white; }
        .btn-main { background: #00ccff; width: 100%; margin-top: 10px; }
        .user-card { background: #252525; padding: 15px; margin-bottom: 10px; border-radius: 8px; border-left: 5px solid #555; cursor: pointer; }
        .user-card.online { border-left-color: #00e676; }
        
        /* –ú–æ–¥–∞–ª–∫–∞ */
        .modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%,-50%); background: #222; padding: 20px; border: 1px solid #555; border-radius: 10px; display: none; z-index: 1000; width: 300px; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; z-index: 999; }
        .modal-btn { width: 100%; margin-bottom: 10px; background: #444; }
        .btn-green { background: #00e676; color: black; }
        .btn-red { background: #ff3d00; }
    </style>
</head>
<body>
    <h1>üõ†Ô∏è –ê–¥–º–∏–Ω–∫–∞</h1>

    <div class="box">
        <h2>üåç –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ò–≥—Ä—ã</h2>
        <div class="row"><span>–ó–∞—Ä–ø–ª–∞—Ç–∞ (–ë–∞–∑–∞)</span> <input id="basePay" type="number"></div>
        <div class="row"><span>–ò–Ω—Ñ–ª—è—Ü–∏—è (0.05)</span> <input id="infRate" type="number" step="0.01"></div>
        <div class="row"><span>–¶–µ–Ω—ã –≤ –º–∞–≥–∞–∑–∏–Ω–µ (x)</span> <input id="priceMult" type="number" step="0.1"></div>
        <div class="row"><span>–°–∫–æ—Ä–æ—Å—Ç—å –∫—É—Ä—å–µ—Ä–∞ (x)</span> <input id="speedMult" type="number" step="0.1"></div>
        <button class="btn-main" onclick="save()">–°–û–•–†–ê–ù–ò–¢–¨ –í–°–ï–ú</button>
    </div>

    <div class="box">
        <h2>üë• –ò–≥—Ä–æ–∫–∏</h2>
        <div id="list">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <div class="overlay" id="overlay" onclick="closeM()"></div>
    <div class="modal" id="modal">
        <h3 id="m-name">–ò–≥—Ä–æ–∫</h3>
        <button class="modal-btn btn-green" onclick="act('money')">üí∞ –î–∞—Ç—å/–ó–∞–±—Ä–∞—Ç—å –î–µ–Ω–µ–≥</button>
        <button class="modal-btn" onclick="act('repair')">üîß –ü–æ—á–∏–Ω–∏—Ç—å –í—Å—ë</button>
        <button class="modal-btn" onclick="act('gift')">üéÅ –î–∞—Ç—å –ï–¥—ã</button>
        <button class="modal-btn btn-red" onclick="act('reset')">üíÄ –û–±–Ω—É–ª–∏—Ç—å</button>
        <button class="modal-btn btn-red" onclick="act('ban')">‚õî –ë–∞–Ω/–†–∞–∑–±–∞–Ω</button>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        const firebaseConfig = { apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk", authDomain: "warszawa-courier.firebaseapp.com", databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app", projectId: "warszawa-courier", storageBucket: "warszawa-courier.firebasestorage.app", messagingSenderId: "295860613508", appId: "1:295860613508:web:86fe8364377d6875612dd1", measurementId: "G-TGSCHBVLX2" };
        firebase.initializeApp(firebaseConfig); const db = firebase.database();

        let currentUid = null;

        db.ref('config').on('value', s => {
            const c = s.val() || {};
            document.getElementById('basePay').value = c.basePay || 12;
            document.getElementById('infRate').value = c.inflationRate || 0.05;
            document.getElementById('priceMult').value = c.priceMult || 1.0;
            document.getElementById('speedMult').value = c.speedMult || 1.0;
        });

        function save() {
            db.ref('config').update({
                basePay: parseFloat(document.getElementById('basePay').value),
                inflationRate: parseFloat(document.getElementById('infRate').value),
                priceMult: parseFloat(document.getElementById('priceMult').value),
                speedMult: parseFloat(document.getElementById('speedMult').value)
            });
            alert('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!');
        }

        db.ref('users').on('value', s => {
            const list = document.getElementById('list'); list.innerHTML = '';
            s.forEach(c => {
                const u = c.val(); const uid = c.key;
                const online = (Date.now() - u.lastActive) < 60000;
                list.innerHTML += `<div class="user-card ${online?'online':''}" onclick="openM('${uid}','${u.name}')">
                    <b>${u.name}</b> ${u.isBanned?'(–ë–ê–ù)':''} <br> 
                    –ë–∞–ª–∞–Ω—Å: ${u.balance.toFixed(2)} | –î–æ–ª–≥: ${u.debt}
                </div>`;
            });
        });

        function openM(uid, name) { currentUid = uid; document.getElementById('m-name').innerText = name; document.getElementById('overlay').style.display='block'; document.getElementById('modal').style.display='block'; }
        function closeM() { document.getElementById('overlay').style.display='none'; document.getElementById('modal').style.display='none'; }

        function act(type) {
            if(!currentUid) return;
            if(type === 'money') {
                let v = prompt("–°–∫–æ–ª—å–∫–æ –¥–æ–±–∞–≤–∏—Ç—å? (–∏–ª–∏ -100 —á—Ç–æ–±—ã –∑–∞–±—Ä–∞—Ç—å)");
                if(v) db.ref('users/'+currentUid).update({balance: parseFloat(v), adminEdit: true});
            }
            if(type === 'repair') {
                db.ref('users/'+currentUid+'/items').set({bike:100,bag:100,phone:100,gear:100});
                alert('–ü–æ—á–∏–Ω–µ–Ω–æ');
            }
            if(type === 'gift') {
                db.ref('users/'+currentUid+'/inventory').update({water:5, bar:5});
                alert('–ï–¥–∞ –≤—ã–¥–∞–Ω–∞');
            }
            if(type === 'reset') {
                if(confirm('–¢–æ—á–Ω–æ –æ–±–Ω—É–ª–∏—Ç—å?')) db.ref('users/'+currentUid).update({balance:0, debt:0, items:{bike:100,bag:100,phone:100,gear:100}, repairs:{bike:0,bag:0,phone:0,gear:0}, adminEdit: true});
            }
            if(type === 'ban') {
                db.ref('users/'+currentUid+'/isBanned').transaction(v => !v);
                alert('–°—Ç–∞—Ç—É—Å –±–∞–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω');
            }
            closeM();
        }
    </script>
</body>
</html>
