<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WOLT GOD MODE | Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

    <style>
        :root {
            --bg: #121212;
            --panel: #1e1e1e;
            --border: #333;
            --text: #e0e0e0;
            --accent: #00e676;
            --danger: #ff3d00;
            --info: #2979ff;
            --warn: #ffea00;
        }

        body { margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); height: 100vh; display: flex; overflow: hidden; }
        
        /* SIDEBAR (LIST) */
        .sidebar { width: 350px; background: var(--panel); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
        .search-box { padding: 15px; border-bottom: 1px solid var(--border); }
        .search-input { width: 100%; padding: 10px; background: #2c2c2c; border: 1px solid #444; color: white; border-radius: 6px; box-sizing: border-box; }
        
        /* –ù–û–í–ê–Ø –ù–ê–í–ò–ì–ê–¶–ò–Ø (–í –°–¢–ò–õ–ï –°–¢–ê–†–û–ì–û –î–ò–ó–ê–ô–ù–ê) */
        .nav-bar { display: flex; border-bottom: 1px solid var(--border); background: #1a1a1a; }
        .nav-btn { flex: 1; padding: 10px; background: transparent; border: none; color: #666; cursor: pointer; font-size: 14px; transition: 0.2s; border-bottom: 2px solid transparent; }
        .nav-btn:hover { color: white; background: #252525; }
        .nav-btn.active { color: var(--accent); border-bottom-color: var(--accent); }

        .player-list { flex: 1; overflow-y: auto; }
        .player-item { padding: 15px; border-bottom: 1px solid var(--border); cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: space-between; }
        .player-item:hover { background: #252525; }
        .player-item.active { background: #2c3e50; border-left: 4px solid var(--info); }
        .player-item.banned { opacity: 0.5; background: #2a0000; }

        .p-info h3 { margin: 0 0 5px 0; font-size: 16px; color: white; }
        .p-meta { font-size: 12px; color: #888; display: flex; gap: 10px; align-items: center; }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; background: #555; display: inline-block; margin-right: 5px; }
        .online .status-dot { background: var(--accent); box-shadow: 0 0 5px var(--accent); }
        .offline .status-dot { background: #555; }

        /* MAIN PANEL */
        .main { flex: 1; padding: 30px; overflow-y: auto; display: none; }
        .main.visible { display: block; }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 1px solid var(--border); padding-bottom: 20px; }
        .user-title h1 { margin: 0; color: var(--info); }
        .user-id { color: #666; font-family: monospace; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        
        .card { background: var(--panel); padding: 20px; border-radius: 12px; border: 1px solid var(--border); }
        .card h3 { margin-top: 0; border-bottom: 1px solid #333; padding-bottom: 10px; color: #aaa; font-size: 14px; text-transform: uppercase; }
        
        .stat-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px; }
        .val { font-weight: bold; color: white; }
        .val.bad { color: var(--danger); }

        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        button { padding: 10px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; color: white; transition: 0.2s; }
        button:hover { filter: brightness(1.2); }
        button:active { transform: scale(0.98); }

        .btn-money { background: #00695c; }
        .btn-heal { background: #1565c0; }
        .btn-item { background: #6a1b9a; }
        .btn-danger { background: #c62828; }
        .btn-warn { background: #f57f17; color: black; }
        .btn-save { background: var(--accent); color: black; width: 100%; margin-top: 10px; }

        .empty-state { flex: 1; display: flex; align-items: center; justify-content: center; color: #444; font-size: 20px; }

        /* --- –°–¢–ò–õ–ò –î–õ–Ø –ù–ê–°–¢–†–û–ï–ö (–ù–û–í–´–ï) --- */
        .config-input { width: 100%; background: #222; border: 1px solid #444; color: white; padding: 8px; border-radius: 5px; margin-bottom: 10px; box-sizing: border-box; }
        .config-label { font-size: 12px; color: #888; margin-bottom: 4px; display: block; }
        
        /* --- –°–¢–ò–õ–ò –î–õ–Ø –õ–û–ì–û–í (–ù–û–í–´–ï) --- */
        .log-entry { padding: 8px; border-bottom: 1px solid #333; font-size: 12px; font-family: monospace; display: flex; gap: 10px; }
        .log-time { color: #666; min-width: 60px; }
        .log-user { color: var(--accent); font-weight: bold; min-width: 100px; }
        .log-msg { color: #ccc; }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="search-box">
            <input type="text" id="search" class="search-input" placeholder="üîç –ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞..." onkeyup="renderList()">
        </div>
        
        <div class="nav-bar">
            <button class="nav-btn active" onclick="showView('players', this)"><i class="fa-solid fa-user"></i> –ò–≥—Ä–æ–∫–∏</button>
            <button class="nav-btn" onclick="showView('config', this)"><i class="fa-solid fa-sliders"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <button class="nav-btn" onclick="showView('logs', this)"><i class="fa-solid fa-list"></i> –õ–æ–≥–∏</button>
        </div>

        <div id="list-container" class="player-list">
            <div style="padding:20px; text-align:center; color:#666">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
        <div style="padding:10px; font-size:11px; text-align:center; color:#444">
            WARSZAWA_FOREVER ADMIN v3.0
        </div>
    </div>

    <div id="view-players" class="main visible">
        <div id="empty-state" class="empty-state">
            –í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ —Å–ª–µ–≤–∞
        </div>

        <div id="player-panel" style="display:none">
            <div class="header">
                <div class="user-title">
                    <h1 id="p-name">Player Name</h1>
                    <span id="p-id" class="user-id">ID: ...</span>
                    <div id="p-status" style="margin-top:5px; font-size:12px; font-weight:bold">OFFLINE</div>
                </div>
                <div style="text-align:right">
                    <div style="font-size:30px; color:var(--accent)" id="p-balance">0.00 PLN</div>
                    <div style="font-size:12px; color:#888">–ë–∞–ª–∞–Ω—Å</div>
                </div>
            </div>
            
            <div id="auth-info-box" style="background:#263238; padding:15px; border-radius:8px; margin-bottom:20px; border:1px solid #37474f; font-family:monospace">
                 –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤—Ö–æ–¥–∞...
            </div>

            <div class="grid">
                <div class="card">
                    <h3>üí∞ –§–∏–Ω–∞–Ω—Å—ã</h3>
                    <div class="stat-row"><span>–¢–µ–∫—É—â–∏–π:</span> <span class="val" id="val-bal">0</span></div>
                    <div class="stat-row"><span>–î–æ–ª–≥:</span> <span class="val" id="val-debt" style="color:red">0</span></div>
                    <div class="controls">
                        <button class="btn-money" onclick="modBalance(1000)">+1K PLN</button>
                        <button class="btn-money" onclick="modBalance(10000)">+10K PLN</button>
                        <button class="btn-warn" onclick="modBalance(-1000)">-1000 (–®—Ç—Ä–∞—Ñ)</button>
                        <button class="btn-money" style="background:#2e7d32" onclick="clearDebt()">–°–Ω—è—Ç—å –¥–æ–ª–≥</button>
                    </div>
                </div>

                <div class="card">
                    <h3>‚ù§Ô∏è –°–æ—Å—Ç–æ—è–Ω–∏–µ</h3>
                    <div class="stat-row"><span>–≠–Ω–µ—Ä–≥–∏—è:</span> <span class="val" id="val-energy">0%</span></div>
                    <div class="stat-row"><span>–í–æ–¥–∞:</span> <span class="val" id="val-water">0%</span></div>
                    <div class="stat-row"><span>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ:</span> <span class="val" id="val-mood">0%</span></div>
                    <div class="controls">
                        <button class="btn-heal" onclick="setStat('needs', {energy:100, water:100, mood:100})">–í–´–õ–ï–ß–ò–¢–¨ –í–°–Å</button>
                        <button class="btn-heal" style="background:#0277bd" onclick="killStats()">–£–±–∏—Ç—å (1%)</button>
                    </div>
                </div>

                <div class="card">
                    <h3>üéí –≠–∫–∏–ø–∏—Ä–æ–≤–∫–∞</h3>
                    <div class="stat-row"><span>–í–µ–ª–∏–∫:</span> <span class="val" id="val-bike">0%</span></div>
                    <div class="stat-row"><span>–°—É–º–∫–∞:</span> <span class="val" id="val-bag">0%</span></div>
                    <div class="controls">
                        <button class="btn-item" onclick="setStat('items', {bike:100, bag:100, phone:100, gear:100})">–ü–æ—á–∏–Ω–∏—Ç—å –≤—Å—ë</button>
                        <button class="btn-item" onclick="giveItem('water', 5)">+5 –í–æ–¥—ã</button>
                    </div>
                </div>

                <div class="card">
                    <h3>üöñ –¢–∞–∫—Å–∏ / Cyber</h3>
                    <div class="stat-row"><span>–ê–≤—Ç–æ:</span> <span class="val" id="val-car">–ù–µ—Ç</span></div>
                    <div class="stat-row"><span>–õ–∏—Ü–µ–Ω–∑–∏—è:</span> <span class="val" id="val-lic">–ù–µ—Ç</span></div>
                    <div class="controls">
                        <button class="btn-item" style="background:#d500f9" onclick="giveCyberCar()">üéÅ –í–´–î–ê–¢–¨ CYBER-X</button>
                        <button class="btn-item" style="background:#ff9800; color:black" onclick="unlockTaxi()">üîì –û—Ç–∫—Ä—ã—Ç—å —Ç–∞–∫—Å–∏</button>
                    </div>
                </div>

                <div class="card" style="border-color: var(--danger)">
                    <h3 style="color:var(--danger)">‚ò†Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–º</h3>
                    <div class="stat-row"><span>–ë–∞–Ω:</span> <span class="val" id="val-banned">–ù–ï–¢</span></div>
                    <div class="controls">
                        <button class="btn-danger" onclick="toggleBan()">–ë–ê–ù / –†–ê–ó–ë–ê–ù</button>
                        <button class="btn-danger" style="background:#b71c1c" onclick="fullReset()">–°–ë–†–û–°–ò–¢–¨ (WIPE)</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="view-config" class="main">
        <h1 style="color:var(--warn)">‚öôÔ∏è –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h1>
        <p style="color:#666; font-size:12px">–ò–∑–º–µ–Ω–µ–Ω–∏–µ —ç–∫–æ–Ω–æ–º–∏–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤.</p>

        <div class="grid">
            <div class="card">
                <h3>üíµ –¢–∞—Ä–∏—Ñ—ã –∏ –ó–∞—Ä–ø–ª–∞—Ç—ã</h3>
                <label class="config-label">–ë–∞–∑–æ–≤–∞—è –ø–æ–¥–∞—á–∞ (PLN)</label>
                <input type="number" id="cfg-basePickupPay" class="config-input">
                <label class="config-label">–û–ø–ª–∞—Ç–∞ –∑–∞ –ö–ú (PLN)</label>
                <input type="number" id="cfg-perKmPay" class="config-input">
                <label class="config-label">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –∏–Ω—Ñ–ª—è—Ü–∏–∏ (0.1 = 10%)</label>
                <input type="number" id="cfg-inflationRate" class="config-input">
            </div>

            <div class="card">
                <h3>‚è± –¢–∞–π–º–µ—Ä—ã (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)</h3>
                <label class="config-label">–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ (–°–µ–∫)</label>
                <input type="number" id="cfg-deliveryTime" class="config-input">
                <label class="config-label">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–±–∫–∏ (–ú—Å)</label>
                <input type="number" id="cfg-trafficDuration" class="config-input">
            </div>

            <div class="card">
                <h3>üé≤ –®–∞–Ω—Å—ã –∏ –†–∞—Å—Ö–æ–¥</h3>
                <label class="config-label">–®–∞–Ω—Å –ß–∞–µ–≤—ã—Ö (0.0 - 1.0)</label>
                <input type="number" step="0.1" id="cfg-tipChance" class="config-input">
                <label class="config-label">–†–∞—Å—Ö–æ–¥ –≠–Ω–µ—Ä–≥–∏–∏ (–∑–∞ —Ç–∏–∫)</label>
                <input type="number" step="0.01" id="cfg-energyDrain" class="config-input">
                <label class="config-label">–†–∞—Å—Ö–æ–¥ –í–æ–¥—ã (–∑–∞ —Ç–∏–∫)</label>
                <input type="number" step="0.01" id="cfg-waterDrain" class="config-input">
            </div>
            
            <div class="card" style="grid-column: span 2">
                <h3>üè∑ –¶–µ–Ω—ã –ú–∞–≥–∞–∑–∏–Ω–∞ (JSON Override)</h3>
                <textarea id="cfg-itemPrices" class="config-input" style="height:80px" placeholder='{"water": 5.0, "gas": 15.0}'></textarea>
                <button class="btn-save" onclick="saveConfig()">üíæ –°–û–•–†–ê–ù–ò–¢–¨ –ù–ê–°–¢–†–û–ô–ö–ò</button>
            </div>
        </div>
    </div>

    <div id="view-logs" class="main">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px">
            <h1>üìú –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞</h1>
            <button class="btn-item" style="width:auto" onclick="loadLogs()">–û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>
        <div id="logs-container" style="background:#1a1a1a; padding:10px; border-radius:10px; height:80vh; overflow-y:auto; border:1px solid #333">
            –ó–∞–≥—Ä—É–∑–∫–∞...
        </div>
    </div>

<script>
    // === CONFIG ===
    const firebaseConfig = {
        apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk",
        authDomain: "warszawa-courier.firebaseapp.com",
        databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "warszawa-courier",
        storageBucket: "warszawa-courier.firebasestorage.app",
        messagingSenderId: "295860613508",
        appId: "1:295860613508:web:86fe8364377d6875612dd1"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let allPlayers = {};
    let usersLookup = {};
    let selectedId = null;

    // === –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –≠–ö–†–ê–ù–û–í ===
    function showView(viewId, btn) {
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
        document.getElementById('view-players').style.display = 'none';
        document.getElementById('view-config').style.display = 'none';
        document.getElementById('view-logs').style.display = 'none';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π
        document.getElementById('view-' + viewId).style.display = 'block';

        // –ö–Ω–æ–ø–∫–∏
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        // –õ–æ–≥–∏–∫–∞ –¥–ª—è –≤–∫–ª–∞–¥–æ–∫
        if(viewId === 'config') loadConfig();
        if(viewId === 'logs') loadLogs();
    }

    // === –ë–î –°–õ–£–®–ê–¢–ï–õ–ò ===
    db.ref('players').on('value', snap => {
        allPlayers = snap.val() || {};
        // –†–µ–Ω–¥–µ—Ä–∏–º —Å–ø–∏—Å–æ–∫ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –º—ã –Ω–∞ –≤–∫–ª–∞–¥–∫–µ –∏–≥—Ä–æ–∫–æ–≤
        if(document.getElementById('view-players').style.display !== 'none') {
            renderList();
        }
        if(selectedId && allPlayers[selectedId]) renderMain(selectedId);
    });

    db.ref('users_lookup').on('value', snap => {
        usersLookup = snap.val() || {};
        if(selectedId) renderMain(selectedId);
    });

    // === –†–ï–ù–î–ï–† –ò–ì–†–û–ö–û–í ===
    function renderList() {
        const container = document.getElementById('list-container');
        const search = document.getElementById('search').value.toLowerCase();
        let html = '';
        const now = Date.now();

        const sortedIds = Object.keys(allPlayers).sort((a,b) => {
            const pA = allPlayers[a]; const pB = allPlayers[b];
            return (pB.balance || 0) - (pA.balance || 0);
        });

        sortedIds.forEach(id => {
            const p = allPlayers[id];
            const name = p.name || '–ë–µ–∑ –∏–º–µ–Ω–∏';
            if (!name.toLowerCase().includes(search) && !id.toLowerCase().includes(search)) return;
            const isOnline = (now - (p.lastSeen || 0)) < 60000;
            const statusClass = isOnline ? 'online' : 'offline';
            const activeClass = (id === selectedId) ? 'active' : '';
            html += `
            <div class="player-item ${statusClass} ${activeClass}" onclick="selectPlayer('${id}')">
                <div class="p-info">
                    <h3><span class="status-dot"></span> ${name}</h3>
                    <div class="p-meta"><span>${(p.balance || 0).toFixed(0)} PLN</span></div>
                </div>
            </div>`;
        });
        container.innerHTML = html || '<div style="padding:20px;text-align:center;color:#666">–ù–∏–∫–æ–≥–æ –Ω–µ—Ç</div>';
    }

    function selectPlayer(id) {
        selectedId = id;
        document.getElementById('empty-state').style.display = 'none';
        document.getElementById('player-panel').style.display = 'block';
        renderMain(id);
    }

    function renderMain(id) {
        const p = allPlayers[id];
        if(!p) return;
        document.getElementById('p-name').textContent = p.name || 'Unknown';
        document.getElementById('p-id').textContent = id;
        document.getElementById('p-balance').textContent = (p.balance || 0).toFixed(2) + ' PLN';
        
        // Passwords
        let authHtml = `<span style="color:#888">Telegram / –ê–≤—Ç–æ-–≤—Ö–æ–¥</span>`;
        const loginEntry = Object.values(usersLookup).find(u => u.playerId === id);
        if(loginEntry) {
            authHtml = `<div>Login: <b style="color:white">${loginEntry.login}</b> | Pass: <b style="color:var(--accent)">${loginEntry.pass}</b></div>`;
        }
        document.getElementById('auth-info-box').innerHTML = authHtml;

        // Stats
        document.getElementById('val-bal').textContent = (p.balance || 0).toFixed(2);
        document.getElementById('val-debt').textContent = (p.debt || 0).toFixed(2);
        const safe = (obj, key) => (obj && obj[key] !== undefined) ? Math.floor(obj[key]) : 0;
        document.getElementById('val-energy').textContent = safe(p.stats, 'energy') + '%';
        document.getElementById('val-water').textContent = safe(p.stats, 'water') + '%';
        document.getElementById('val-mood').textContent = safe(p.stats, 'mood') + '%';
        document.getElementById('val-bike').textContent = safe(p.items, 'bike') + '%';
        document.getElementById('val-bag').textContent = safe(p.items, 'bag') + '%';
        document.getElementById('val-car').textContent = (p.taxi && p.taxi.vehicle) ? p.taxi.vehicle.toUpperCase() : '–ü–µ—à–∫–æ–º';
        document.getElementById('val-lic').textContent = (p.taxi && p.taxi.licenses && p.taxi.licenses.driver) ? '–ï—Å—Ç—å' : '–ù–µ—Ç';
        document.getElementById('val-banned').textContent = p.isBanned ? '–î–ê' : '–ù–µ—Ç';
    }

    // === ACTIONS ===
    function sendCmd(type, data) {
        if(!selectedId) return;
        db.ref('players/' + selectedId + '/adminInbox').push({ type: type, ...data });
    }
    function modBalance(amount) { if(selectedId) sendCmd('SET_VAR', { path: 'balance', value: (allPlayers[selectedId].balance||0) + amount }); }
    function clearDebt() { sendCmd('SET_VAR', { path: 'debt', value: 0 }); sendCmd('SET_VAR', { path: 'debtOverdue', value: false }); }
    function setStat(cat, values) { for (let [k, v] of Object.entries(values)) sendCmd('SET_VAR', { path: `${cat}.${k}`, value: v }); }
    function killStats() { setStat('needs', { energy: 1, water: 1, mood: 1 }); }
    function giveItem(item, count) { if(selectedId) sendCmd('SET_VAR', { path: `inventory.${item}`, value: (allPlayers[selectedId].inventory?.[item]||0) + count }); }
    function unlockTaxi() { sendCmd('SET_VAR', { path: 'taxi.unlocked', value: true }); sendCmd('SET_VAR', { path: 'taxi.licenses.driver', value: true }); sendCmd('SET_VAR', { path: 'taxi.licenses.insurance', value: true }); sendCmd('SET_VAR', { path: 'taxi.licenses.taxi', value: true }); alert('–í—ã–¥–∞–Ω–æ'); }
    function giveCyberCar() { sendCmd('SET_VAR', { path: 'taxi.vehicle', value: 'cyber_x' }); sendCmd('SET_VAR', { path: 'taxi.active', value: true }); alert('–í—ã–¥–∞–Ω–æ'); }
    function toggleBan() { if(selectedId) sendCmd('SET_VAR', { path: 'isBanned', value: !allPlayers[selectedId].isBanned }); }
    function fullReset() { if(confirm('RESET?')) sendCmd('FULL_RESET', {}); }

    // === GLOBAL CONFIG ===
    function loadConfig() {
        db.ref('config').once('value', snap => {
            const c = snap.val() || {};
            document.getElementById('cfg-basePickupPay').value = c.basePickupPay || 4.0;
            document.getElementById('cfg-perKmPay').value = c.perKmPay || 1.5;
            document.getElementById('cfg-inflationRate').value = c.inflationRate || 0.1;
            document.getElementById('cfg-deliveryTime').value = c.deliveryTime || 60;
            document.getElementById('cfg-trafficDuration').value = c.trafficDuration || 5000;
            document.getElementById('cfg-tipChance').value = c.tipChance || 0.5;
            document.getElementById('cfg-energyDrain').value = c.energyDrain || 0.15;
            document.getElementById('cfg-waterDrain').value = c.waterDrain || 0.10;
            document.getElementById('cfg-itemPrices').value = JSON.stringify(c.itemPrices || {});
        });
    }

    function saveConfig() {
        if(!confirm("–ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤—Å–µ—Ö?")) return;
        const cfg = {
            basePickupPay: parseFloat(document.getElementById('cfg-basePickupPay').value),
            perKmPay: parseFloat(document.getElementById('cfg-perKmPay').value),
            inflationRate: parseFloat(document.getElementById('cfg-inflationRate').value),
            deliveryTime: parseInt(document.getElementById('cfg-deliveryTime').value),
            trafficDuration: parseInt(document.getElementById('cfg-trafficDuration').value),
            tipChance: parseFloat(document.getElementById('cfg-tipChance').value),
            energyDrain: parseFloat(document.getElementById('cfg-energyDrain').value),
            waterDrain: parseFloat(document.getElementById('cfg-waterDrain').value),
            itemPrices: {}
        };
        try { cfg.itemPrices = JSON.parse(document.getElementById('cfg-itemPrices').value); } catch(e) {}
        db.ref('config').update(cfg).then(()=>alert('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ'));
    }

    // === LOGS ===
    function loadLogs() {
        db.ref('logs').limitToLast(50).once('value', snap => {
            const d = snap.val();
            let html = '';
            if(d) {
                Object.values(d).sort((a,b)=>b.timestamp-a.timestamp).forEach(l => {
                    html += `<div class="log-entry"><div class="log-time">${new Date(l.timestamp).toLocaleTimeString()}</div><div class="log-user">${l.playerName}</div><div class="log-msg">${l.message}</div></div>`;
                });
            }
            document.getElementById('logs-container').innerHTML = html || '–ù–µ—Ç –ª–æ–≥–æ–≤';
        });
    }

    // Start on players tab
    showView('players', document.querySelector('.nav-btn'));

</script>

</body>
</html>
