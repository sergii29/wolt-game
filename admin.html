<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wolt Admin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #121212; color: white; font-family: sans-serif; padding: 20px; overflow-y: auto; }
        .card { background: #1e1e1e; padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid #333; }
        h2 { color: #00ccff; margin-top: 0; }
        .row { display: flex; justify-content: space-between; margin-bottom: 10px; align-items: center; }
        input { background: #333; border: 1px solid #555; color: white; padding: 8px; border-radius: 5px; width: 100px; text-align: center; }
        button { padding: 10px 15px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; color: white; }
        .btn-save { background: #00ccff; width: 100%; margin-top: 10px; }
        .user-item { background: #252525; padding: 15px; margin-bottom: 10px; border-radius: 8px; border-left: 4px solid #555; }
        .user-item.online { border-left-color: #00e676; background: rgba(0, 230, 118, 0.05); }
        .btn-mini { font-size: 12px; padding: 5px 10px; margin-left: 5px; }
        .btn-blue { background: #009de0; } .btn-green { background: #00e676; color: #000; } .btn-red { background: #ff3d00; }
    </style>
</head>
<body>
    <h1>üõ°Ô∏è Admin Panel v2.0</h1>

    <div class="card">
        <h2>üåç –≠–∫–æ–Ω–æ–º–∏–∫–∞</h2>
        <div class="row"><span>–ë–∞–∑–∞ (PLN)</span> <input id="basePay" type="number"></div>
        <div class="row"><span>–ò–Ω—Ñ–ª—è—Ü–∏—è</span> <input id="infRate" type="number" step="0.01"></div>
        <div class="row"><span>–ú–Ω–æ–∂–∏—Ç–µ–ª—å –¶–µ–Ω</span> <input id="priceMult" type="number" step="0.1"></div>
        <div class="row"><span>–®–∞–Ω—Å –ü—Ä–æ–±–∫–∏</span> <input id="chance" type="number" step="0.05"></div>
        <div class="row"><span>–†–∞—Å—Ö–æ–¥ –≠–Ω–µ—Ä–≥–∏–∏</span> <input id="energy" type="number" step="0.05"></div>
        <button class="btn-save" onclick="saveConf()">–°–û–•–†–ê–ù–ò–¢–¨</button>
    </div>

    <div class="card">
        <h2>üë• –ò–≥—Ä–æ–∫–∏ (<span id="online-cnt">0</span> online)</h2>
        <div id="list">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        const firebaseConfig = { apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk", authDomain: "warszawa-courier.firebaseapp.com", databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app", projectId: "warszawa-courier", storageBucket: "warszawa-courier.firebasestorage.app", messagingSenderId: "295860613508", appId: "1:295860613508:web:86fe8364377d6875612dd1", measurementId: "G-TGSCHBVLX2" };
        firebase.initializeApp(firebaseConfig); const db = firebase.database();

        db.ref('config').on('value', s => {
            const c = s.val() || {};
            document.getElementById('basePay').value = c.basePay || 12;
            document.getElementById('infRate').value = c.inflationRate || 0.05;
            document.getElementById('priceMult').value = c.priceMult || 1.0;
            document.getElementById('chance').value = c.eventChance || 0.1;
            document.getElementById('energy').value = c.energyCost || 0.15;
        });

        function saveConf() {
            db.ref('config').update({
                basePay: parseFloat(document.getElementById('basePay').value),
                inflationRate: parseFloat(document.getElementById('infRate').value),
                priceMult: parseFloat(document.getElementById('priceMult').value),
                eventChance: parseFloat(document.getElementById('chance').value),
                energyCost: parseFloat(document.getElementById('energy').value)
            });
            alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!');
        }

        db.ref('users').on('value', s => {
            const list = document.getElementById('list'); list.innerHTML = '';
            let on = 0;
            s.forEach(c => {
                const u = c.val(); const uid = c.key;
                const online = (Date.now() - u.lastActive) < 60000;
                if(online) on++;
                list.innerHTML += `
                    <div class="user-item ${online?'online':''}">
                        <div class="row"><b>${u.name}</b> <small>${uid}</small></div>
                        <div class="row">üí∞ ${u.balance.toFixed(2)} | üè¶ ${u.debt.toFixed(0)}</div>
                        <div class="row" style="justify-content:flex-end">
                            <button class="btn-mini btn-blue" onclick="setBal('${uid}')">$</button>
                            <button class="btn-mini btn-green" onclick="heal('${uid}')">üöë</button>
                            <button class="btn-mini btn-green" onclick="fix('${uid}')">üîß</button>
                            <button class="btn-mini btn-red" onclick="ban('${uid}', ${!u.isBanned})">${u.isBanned?'UNBAN':'BAN'}</button>
                        </div>
                    </div>`;
            });
            document.getElementById('online-cnt').textContent = on;
        });

        function setBal(uid) { let v = prompt("–ù–æ–≤—ã–π –±–∞–ª–∞–Ω—Å:"); if(v) db.ref('users/'+uid).update({balance: parseFloat(v), adminEdit: true}); }
        function heal(uid) { db.ref('users/'+uid+'/needs').set({energy:100,water:100,mood:100}); db.ref('users/'+uid+'/inventory').transaction(i=>{if(!i)i={water:0,bar:0,energy_drink:0,coffee:0}; i.water+=5; i.bar+=5; return i;}); }
        function fix(uid) { db.ref('users/'+uid+'/items').set({bike:100,bag:100,phone:100,gear:100}); }
        function ban(uid, b) { if(confirm(b?"–ó–∞–±–∞–Ω–∏—Ç—å?":"–†–∞–∑–±–∞–Ω–∏—Ç—å?")) db.ref('users/'+uid).update({isBanned: b}); }
    </script>
</body>
</html>
