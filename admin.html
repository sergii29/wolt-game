<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ê–¥–º–∏–Ω–∫–∞ ‚Ä¢ GOD MODE</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="database.js"></script>

<style>
body{background:#0b0e13;color:#e8ecf1;font-family:Arial;padding:12px}
.section{background:#141922;border-radius:14px;padding:14px;margin-bottom:16px}
h2{margin:0 0 10px}
label{font-size:13px;color:#9aa4b2}
input,select,button{width:100%;padding:10px;margin:6px 0;background:#0f1420;color:#fff;border-radius:10px;border:none}
button{background:#2a7cff;font-weight:bold}
.row{display:flex;gap:10px}
.row>div{flex:1}
.online{color:#3ddc84}
.offline{color:#ff5c5c}
.small{font-size:12px;color:#9aa4b2}
</style>
</head>

<body>

<!-- –ò–ì–†–û–ö–ò -->
<div class="section">
<h2>üë§ –ò–≥—Ä–æ–∫–∏</h2>

<select id="playerSelect"></select>
<div id="playerStatus"></div>

<label>–ë–∞–ª–∞–Ω—Å</label>
<input id="pBalance" type="number">

<label>–≠–Ω–µ—Ä–≥–∏—è</label>
<input id="pEnergy" type="number">

<label>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</label>
<input id="pMood" type="number">

<button onclick="savePlayer()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä–æ–∫–∞</button>
</div>

<!-- –ö–û–†–ó–ò–ù–ê / –ò–ù–í–ï–ù–¢–ê–†–¨ -->
<div class="section">
<h2>üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏–≥—Ä–æ–∫–∞</h2>

<select id="invItem"></select>
<input id="invQty" type="number" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ">

<button onclick="addItem()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
<button onclick="removeItem()">‚ûñ –£–±—Ä–∞—Ç—å</button>

<pre id="invView"></pre>
</div>

<!-- –ú–ê–ì–ê–ó–ò–ù -->
<div class="section">
<h2>üõí –ú–∞–≥–∞–∑–∏–Ω (—Ü–µ–Ω—ã –∏ —Ç–æ–≤–∞—Ä—ã)</h2>

<select id="shopItem"></select>

<label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
<input id="shopName">

<label>–¶–µ–Ω–∞</label>
<input id="shopPrice" type="number">

<label>–≠–Ω–µ—Ä–≥–∏—è</label>
<input id="shopEnergy" type="number">

<button onclick="saveShop()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä</button>

<hr>

<label>–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä (ID)</label>
<input id="newItemId">
<button onclick="createItem()">‚ûï –°–æ–∑–¥–∞—Ç—å —Ç–æ–≤–∞—Ä</button>
</div>

<!-- –¶–ï–õ–ò -->
<div class="section">
<h2>üéØ –¶–µ–ª–∏ (–ª—é–±–æ–π –±—Ä–µ–¥, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—á–µ—à—å)</h2>

<input id="goalMin" type="number" placeholder="–ú–∏–Ω—É—Ç—ã">
<input id="goalSec" type="number" placeholder="–°–µ–∫—É–Ω–¥—ã">
<input id="goalCount" type="number" placeholder="–î–æ—Å—Ç–∞–≤–∫–∏">
<input id="goalBonus" type="number" placeholder="–ë–æ–Ω—É—Å PLN">

<button onclick="saveGoal()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–µ–ª—å</button>
</div>

<script>
let currentPlayer=null;
let currentItem=null;

/* === –ò–ì–†–û–ö–ò === */
db.ref("players").on("value",s=>{
  playerSelect.innerHTML="";
  s.forEach(p=>{
    const o=document.createElement("option");
    o.value=p.key;o.textContent=p.key;
    playerSelect.appendChild(o);
  });
  if(playerSelect.value) loadPlayer();
});
playerSelect.onchange=loadPlayer;

function loadPlayer(){
  currentPlayer=playerSelect.value;
  db.ref("players/"+currentPlayer).once("value").then(s=>{
    const d=s.val()||{};
    pBalance.value=d.balance||0;
    pEnergy.value=d.energy||0;
    pMood.value=d.mood||0;
    playerStatus.innerHTML=d.online
      ? "<span class='online'>–æ–Ω–ª–∞–π–Ω</span>"
      : "<span class='offline'>–æ—Ñ—Ñ–ª–∞–π–Ω</span>";
    loadInventory();
  });
}
function savePlayer(){
  db.ref("players/"+currentPlayer).update({
    balance:+pBalance.value,
    energy:+pEnergy.value,
    mood:+pMood.value
  });
}

/* === –ò–ù–í–ï–ù–¢–ê–†–¨ === */
function loadInventory(){
  db.ref("players/"+currentPlayer+"/inventory").on("value",s=>{
    invView.textContent=JSON.stringify(s.val(),null,2);
  });
}
function addItem(){
  db.ref("players/"+currentPlayer+"/inventory/"+invItem.value).transaction(q=>(q||0)+(+invQty.value));
}
function removeItem(){
  db.ref("players/"+currentPlayer+"/inventory/"+invItem.value).transaction(q=>Math.max(0,(q||0)-(+invQty.value)));
}

/* === –ú–ê–ì–ê–ó–ò–ù === */
db.ref("shop/products").on("value",s=>{
  shopItem.innerHTML="";
  invItem.innerHTML="";
  s.forEach(p=>{
    const o=document.createElement("option");
    o.value=p.key;o.textContent=p.key;
    shopItem.appendChild(o);
    invItem.appendChild(o.cloneNode(true));
  });
});
shopItem.onchange=()=>{
  currentItem=shopItem.value;
  db.ref("shop/products/"+currentItem).once("value").then(s=>{
    const d=s.val()||{};
    shopName.value=d.name||"";
    shopPrice.value=d.price||0;
    shopEnergy.value=d.energy||0;
  });
};
function saveShop(){
  db.ref("shop/products/"+currentItem).update({
    name:shopName.value,
    price:+shopPrice.value,
    energy:+shopEnergy.value
  });
}
function createItem(){
  db.ref("shop/products/"+newItemId.value).set({
    name:newItemId.value,
    price:0,
    energy:0
  });
}

/* === –¶–ï–õ–ò === */
function saveGoal(){
  const sec=(+goalMin.value*60)+(+goalSec.value);
  db.ref("goals/daily").set({
    timeSeconds:sec,
    deliveries:+goalCount.value,
    bonus:+goalBonus.value
  });
}
</script>

</body>
</html>
