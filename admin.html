<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOD MODE v9.0</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #f8f9fa; font-family: 'Segoe UI', sans-serif; padding: 15px; color: #333; }
        
        /* HEADER */
        .header { background: white; padding: 15px; border-radius: 12px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .status { font-weight: 800; font-size: 11px; color: #ccc; } .status.on { color: #00c853; }

        /* NAV */
        .nav { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px; margin-bottom: 10px; }
        .nav-btn { flex: 1; padding: 12px; border: 1px solid #eee; background: white; border-radius: 8px; font-weight: 700; color: #666; cursor: pointer; min-width: 100px; white-space: nowrap; }
        .nav-btn.active { background: #333; color: white; border-color: #333; }
        
        .view { display: none; } .view.active { display: block; }

        /* CARDS */
        .card { background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); }
        .card h3 { margin: 0 0 15px 0; font-size: 14px; text-transform: uppercase; color: #333; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; }

        /* INPUTS */
        .row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 1px dashed #f5f5f5; padding-bottom: 5px; }
        label { font-weight: 600; font-size: 13px; color: #555; }
        input { width: 90px; padding: 8px; text-align: center; border: 1px solid #ddd; border-radius: 6px; font-weight: bold; }
        
        /* ROCKET */
        .rk-form { display: grid; gap: 10px; }
        .rk-full { width: 100%; box-sizing: border-box; text-align: left; }
        .rk-item { background: #e3f2fd; padding: 10px; border-radius: 8px; margin-bottom: 5px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #90caf9; }
        
        .btn { width: 100%; padding: 14px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; color: white; margin-top: 10px; }
        .btn-green { background: #00c853; } .btn-blue { background: #2962ff; } .btn-red { background: #ff1744; }

        /* PLAYERS */
        .p-item { background: white; padding: 12px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; border-left: 4px solid #eee; }
        .p-item.online { border-left-color: #00c853; }
        
        /* MODAL */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 999; justify-content: center; align-items: center; }
        .modal.open { display: flex; }
        .modal-box { background: white; width: 90%; max-width: 400px; padding: 20px; border-radius: 16px; max-height: 90vh; overflow-y: auto; }
    </style>
</head>
<body>

<div class="header">
    <h2 style="margin:0">GOD MODE <span style="font-size:12px; color:#aaa">v9.0</span></h2>
    <div id="status" class="status">CONNECTING...</div>
</div>

<div class="nav">
    <button class="nav-btn active" onclick="tab('rocket')">üöÄ –ê–∫—Ü–∏–∏</button>
    <button class="nav-btn" onclick="tab('tariffs')">‚ö° –¢–∞—Ä–∏—Ñ—ã/–≠–Ω–µ—Ä–≥–∏—è</button>
    <button class="nav-btn" onclick="tab('players')">üë• –ò–≥—Ä–æ–∫–∏</button>
</div>

<div id="rocket" class="view active">
    <div class="card">
        <h3>–°–æ–∑–¥–∞—Ç—å –ê–∫—Ü–∏—é</h3>
        <div class="rk-form">
            <input type="text" id="rk-title" class="rk-full" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫ (–ù–∞–ø—Ä–∏–º–µ—Ä: –í–µ—á–µ—Ä–Ω–∏–π –ñ–æ—Ä)">
            <div style="display:flex; gap:10px">
                <input type="number" id="rk-target" class="rk-full" placeholder="–¶–µ–ª—å (–ó–∞–∫–∞–∑—ã)">
                <input type="number" id="rk-reward" class="rk-full" placeholder="–ù–∞–≥—Ä–∞–¥–∞ (PLN)">
            </div>
            <div style="display:flex; gap:10px">
                <input type="datetime-local" id="rk-start" class="rk-full">
                <input type="datetime-local" id="rk-end" class="rk-full">
            </div>
            <button class="btn btn-blue" onclick="addRocket()">–î–û–ë–ê–í–ò–¢–¨ –í –†–ê–°–ü–ò–°–ê–ù–ò–ï</button>
        </div>
    </div>
    
    <div class="card">
        <h3>–¢–µ–∫—É—â–µ–µ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h3>
        <div id="rk-list">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <button class="btn btn-red" onclick="if(confirm('–£–¥–∞–ª–∏—Ç—å –í–°–ï?')) db.ref('bonuses/list').remove()">–û–ß–ò–°–¢–ò–¢–¨ –í–°–Å</button>
    </div>
</div>

<div id="tariffs" class="view">
    <div class="card">
        <h3>‚öôÔ∏è –°–ª–æ–∂–Ω–æ—Å—Ç—å (–¢—Ä–∞—Ç–∞ –∑–∞ –∫–ª–∏–∫)</h3>
        <div class="row"><label>–≠–Ω–µ—Ä–≥–∏—è (0.15 –Ω–æ—Ä–º)</label><input type="number" id="energyDrain" step="0.01"></div>
        <div class="row"><label>–í–æ–¥–∞ (0.10 –Ω–æ—Ä–º)</label><input type="number" id="waterDrain" step="0.01"></div>
        <div class="row"><label>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (0.05 –Ω–æ—Ä–º)</label><input type="number" id="moodDrain" step="0.01"></div>
        <div class="row"><label>–í—Ä–µ–º—è –∑–∞–∫–∞–∑–∞ (—Å–µ–∫)</label><input type="number" id="deliveryTime"></div>
    </div>

    <div class="card">
        <h3>üí∏ –î–æ—Ö–æ–¥—ã</h3>
        <div class="row"><label>–ë–∞–∑–∞ (–°—Ç–∞—Ä—Ç)</label><input type="number" id="basePickupPay"></div>
        <div class="row"><label>–ó–∞ –ö–ú</label><input type="number" id="perKmPay"></div>
        <div class="row"><label>–¢–∞–∫—Å–∏ (–ú–Ω–æ–∂–∏—Ç–µ–ª—å)</label><input type="number" id="taxiMulti"></div>
        <div class="row"><label>–ò–Ω—Ñ–ª—è—Ü–∏—è (%)</label><input type="number" id="inflationRate"></div>
    </div>
    
    <button class="btn btn-green" onclick="saveConfig()">–°–û–•–†–ê–ù–ò–¢–¨ –ù–ê–°–¢–†–û–ô–ö–ò</button>
</div>

<div id="players" class="view">
    <input type="text" id="search" placeholder="–ü–æ–∏—Å–∫..." style="width:100%; padding:12px; margin-bottom:10px; box-sizing:border-box" onkeyup="renderPlayers()">
    <div id="p-list">...</div>
</div>

<div id="modal" class="modal">
    <div class="modal-box">
        <h2 id="m-name">–ò–≥—Ä–æ–∫</h2>
        <div class="row"><label>–ë–∞–ª–∞–Ω—Å</label><input type="number" id="m-bal"></div>
        <div style="display:flex; gap:10px">
            <button class="btn" style="background:#ffc107; color:black" onclick="giveTaxi()">üéÅ –î–ê–¢–¨ –¢–ê–ö–°–ò</button>
            <button class="btn btn-red" onclick="banUser()">–ë–ê–ù</button>
        </div>
        <button class="btn btn-green" onclick="saveUser()">–°–û–•–†–ê–ù–ò–¢–¨</button>
        <button class="btn" style="background:#ccc; color:#333" onclick="closeModal()">–ó–ê–ö–†–´–¢–¨</button>
    </div>
</div>

<script>
    const fb = { apiKey: "AIzaSyChrQMyO2soPgoEHq_f3aYs5Cs19q3sWEk", authDomain: "warszawa-courier.firebaseapp.com", databaseURL: "https://warszawa-courier-default-rtdb.europe-west1.firebasedatabase.app", projectId: "warszawa-courier", storageBucket: "warszawa-courier.firebasestorage.app", messagingSenderId: "295860613508", appId: "1:295860613508:web:86fe8364377d6875612dd1" };
    firebase.initializeApp(fb);
    const db = firebase.database();
    let players={}, bonuses=[], activeId=null;

    db.ref('.info/connected').on('value', s => document.getElementById('status').className = s.val() ? 'status on' : 'status');

    // LOAD DATA
    db.ref('players').on('value', s => { players = s.val() || {}; renderPlayers(); });
    db.ref('bonuses/list').on('value', s => { 
        bonuses = Object.entries(s.val()||{}).map(([k,v])=>({id:k,...v})); 
        renderBonuses(); 
    });
    db.ref('config').on('value', s => {
        const c = s.val() || {};
        const set = (id,v) => { if(document.getElementById(id)) document.getElementById(id).value = v; };
        set('energyDrain', c.energyDrain||0.15); set('waterDrain', c.waterDrain||0.10); set('moodDrain', c.moodDrain||0.05);
        set('deliveryTime', c.deliveryTime||60);
        set('basePickupPay', c.basePickupPay||4); set('perKmPay', c.perKmPay||1.5); 
        set('taxiMulti', c.taxiMulti||4); set('inflationRate', (c.inflationRate||0.1)*100);
    });

    // FUNCTIONS
    function addRocket() {
        const t=document.getElementById('rk-title').value, g=document.getElementById('rk-target').value, r=document.getElementById('rk-reward').value;
        const s=new Date(document.getElementById('rk-start').value).getTime(), e=new Date(document.getElementById('rk-end').value).getTime();
        if(!t||!g||!r||!s||!e) return alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ!');
        db.ref('bonuses/list').push({title:t, target:parseInt(g), reward:parseFloat(r), startTime:s, endTime:e});
        alert('–î–æ–±–∞–≤–ª–µ–Ω–æ!');
    }

    function renderBonuses() {
        const c=document.getElementById('rk-list'); c.innerHTML='';
        bonuses.sort((a,b)=>a.startTime-b.startTime).forEach(b => {
            const status = Date.now() < b.startTime ? '‚è≥ –°–ö–û–†–û' : (Date.now() > b.endTime ? 'üèÅ –í–°–Å' : 'üî• –ê–ö–¢–ò–í');
            c.innerHTML += `<div class="rk-item"><div><b>${b.title}</b> (${status})<br><small>${new Date(b.startTime).toLocaleString()} - ${new Date(b.endTime).toLocaleString()}</small></div><button onclick="db.ref('bonuses/list/${b.id}').remove()" style="color:red;border:none;background:none;font-weight:bold">X</button></div>`;
        });
    }

    function saveConfig() {
        const get = id => parseFloat(document.getElementById(id).value);
        db.ref('config').update({
            energyDrain: get('energyDrain'), waterDrain: get('waterDrain'), moodDrain: get('moodDrain'),
            deliveryTime: get('deliveryTime'), basePickupPay: get('basePickupPay'),
            perKmPay: get('perKmPay'), taxiMulti: get('taxiMulti'), inflationRate: get('inflationRate')/100
        });
        alert('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!');
    }

    function tab(id) { document.querySelectorAll('.view').forEach(e=>e.classList.remove('active')); document.querySelectorAll('.nav-btn').forEach(e=>e.classList.remove('active')); document.getElementById(id).classList.add('active'); event.target.classList.add('active'); }
    function renderPlayers() { const c=document.getElementById('p-list'); c.innerHTML=''; const term=document.getElementById('search').value.toLowerCase(); Object.entries(players).filter(([k,v])=>(v.name||'').toLowerCase().includes(term)).forEach(([k,p]) => c.innerHTML+=`<div class="p-item ${(Date.now()-(p.lastSeen||0)<15000)?'online':''}" onclick="edit('${k}')"><b>${p.name||'User'}</b> <span>${(p.balance||0).toFixed(2)}</span></div>`); }
    function edit(id) { activeId=id; document.getElementById('m-name').innerText=players[id].name; document.getElementById('m-bal').value=players[id].balance; document.getElementById('modal').classList.add('open'); }
    function closeModal() { document.getElementById('modal').classList.remove('open'); activeId=null; }
    function saveUser() { db.ref('players/'+activeId).update({balance:parseFloat(document.getElementById('m-bal').value)}); closeModal(); }
    function giveTaxi() { db.ref('players/'+activeId+'/taxi').update({unlocked:true, vehicle:'tesla', licenses:{driver:true, insurance:true, taxi:true}}); alert('–í—ã–¥–∞–Ω–æ!'); }
    function banUser() { db.ref('players/'+activeId).update({isBanned:!players[activeId].isBanned}); closeModal(); }
</script>
</body>
</html>

